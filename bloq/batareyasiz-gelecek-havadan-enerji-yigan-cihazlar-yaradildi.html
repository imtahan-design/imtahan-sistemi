<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <base href="/">
    <title>‚ö°Ô∏è Batareyasƒ±z G…ôl…ôc…ôk: "Havadan Enerji" Yƒ±ƒüan Cihazlar Yaradƒ±ldƒ±! ‚Äì ƒ∞mtahan Bloq</title>
    <meta name="description" content="T…ôs…ôvv√ºr edin ki, telefonunuzun enerjisi he√ß vaxt bitmir v…ô siz onu he√ß vaxt adapter…ô taxmƒ±rsƒ±nƒ±z.">
    <meta name="robots" content="index,follow">
    <link rel="canonical" href="https://imtahan.site/bloq/batareyasiz-gelecek-havadan-enerji-yigan-cihazlar-yaradildi">
    <meta property="og:title" content="‚ö°Ô∏è Batareyasƒ±z G…ôl…ôc…ôk: "Havadan Enerji" Yƒ±ƒüan Cihazlar Yaradƒ±ldƒ±! ‚Äì ƒ∞mtahan Bloq">
    <meta property="og:description" content="T…ôs…ôvv√ºr edin ki, telefonunuzun enerjisi he√ß vaxt bitmir v…ô siz onu he√ß vaxt adapter…ô taxmƒ±rsƒ±nƒ±z.">
    <meta property="og:image" content="https://imtahan.site/assets/logo.png">
    <meta property="og:image:alt" content="‚ö°Ô∏è Batareyasƒ±z G…ôl…ôc…ôk: "Havadan Enerji" Yƒ±ƒüan Cihazlar Yaradƒ±ldƒ±! ‚Äì ƒ∞mtahan Bloq">
    <meta property="og:url" content="https://imtahan.site/bloq/batareyasiz-gelecek-havadan-enerji-yigan-cihazlar-yaradildi">
    <meta property="og:type" content="article">
    <meta property="og:site_name" content="ƒ∞mtahan Bloq">
    <meta property="article:published_time" content="2026-01-10T14:59:26.836Z">
    <meta property="article:modified_time" content="2026-01-10T14:59:27.392Z">
    <meta property="article:section" content="Texnoloji Yenilikl…ôr">
    <meta property="article:tag" content="mobil">
    <meta property="article:tag" content="telefon">
    <meta property="article:tag" content="batareya">
    <meta property="article:tag" content="enerji">
    <meta property="article:tag" content="yenilik">
    <meta property="article:tag" content="texnologiya">
    <meta property="article:tag" content="Wi-Fi">
    <meta property="article:tag" content="elektrik">
    <meta property="article:tag" content="xiaomi">
    <meta property="article:tag" content="ƒ∞phone">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="‚ö°Ô∏è Batareyasƒ±z G…ôl…ôc…ôk: "Havadan Enerji" Yƒ±ƒüan Cihazlar Yaradƒ±ldƒ±! ‚Äì ƒ∞mtahan Bloq">
    <meta name="twitter:description" content="T…ôs…ôvv√ºr edin ki, telefonunuzun enerjisi he√ß vaxt bitmir v…ô siz onu he√ß vaxt adapter…ô taxmƒ±rsƒ±nƒ±z.">
    <meta name="twitter:image" content="https://imtahan.site/assets/logo.png">
    <script type="application/ld+json">
    [
      {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "headline": "‚ö°Ô∏è Batareyasƒ±z G…ôl…ôc…ôk: \"Havadan Enerji\" Yƒ±ƒüan Cihazlar Yaradƒ±ldƒ±!",
        "description": "T…ôs…ôvv√ºr edin ki, telefonunuzun enerjisi he√ß vaxt bitmir v…ô siz onu he√ß vaxt adapter…ô taxmƒ±rsƒ±nƒ±z.",
        "image": ["https://imtahan.site/assets/logo.png"],
        "datePublished": "2026-01-10T14:59:26.836Z",
        "dateModified": "2026-01-10T14:59:27.392Z",
        "author": {
          "@type": "Organization",
          "name": "ƒ∞mtahan Bloq",
          "url": "https://imtahan.site"
        },
        "publisher": {
          "@type": "Organization",
          "name": "ƒ∞mtahan Bloq",
          "logo": {
            "@type": "ImageObject",
            "url": "https://imtahan.site/assets/logo.png"
          }
        },
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://imtahan.site/bloq/batareyasiz-gelecek-havadan-enerji-yigan-cihazlar-yaradildi"
        }
      },
      {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Ana S…ôhif…ô",
            "item": "https://imtahan.site/"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Bloq",
            "item": "https://imtahan.site/bloq"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": "‚ö°Ô∏è Batareyasƒ±z G…ôl…ôc…ôk: \"Havadan Enerji\" Yƒ±ƒüan Cihazlar Yaradƒ±ldƒ±!",
            "item": "https://imtahan.site/bloq/batareyasiz-gelecek-havadan-enerji-yigan-cihazlar-yaradildi"
          }
        ]
      }
    ]
    </script>
  <link rel="shortcut icon" href="/assets/logo.png" type="image/png">
  <link rel="icon" href="/assets/logo.png" type="image/png" sizes="32x32">
  <link rel="icon" href="/assets/logo.png" type="image/png" sizes="16x16">
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://imtahansistemi-17659.firebaseapp.com">
  <link rel="preconnect" href="https://firestore.googleapis.com">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&display=swap" rel="stylesheet">
  
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js" defer></script>
  
  <style>
    :root {
      --primary: #6366f1;
      --primary-dark: #4f46e5;
      --primary-light: #e0e7ff;
      --secondary: #ec4899;
      --text-main: #1f2937;
      --text-muted: #6b7280;
      --bg-body: #f3f4f6;
      --bg-card: #ffffff;
      --border: #e5e7eb;
      --radius: 16px;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --gradient-1: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-body);
      color: var(--text-main);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }

    /* Navigation */
    .navbar {
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      position: relative;
      z-index: 100;
      padding: 1rem 0;
    }
    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .nav-logo {
      display: flex;
      align-items: center;
      gap: 12px;
      text-decoration: none;
      color: var(--text-main);
    }
    .nav-logo-icon {
      width: 40px;
      height: 40px;
      background: var(--gradient-1);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
    }
    .nav-logo-text h1 { font-size: 1.25rem; font-weight: 700; line-height: 1.2; }
    .nav-logo-text span { font-size: 0.8rem; color: var(--text-muted); font-weight: 500; }
    .nav-btn {
      padding: 10px 20px;
      border-radius: 12px;
      font-weight: 600;
      font-size: 0.95rem;
      transition: all 0.2s;
      cursor: pointer;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .nav-btn-secondary { color: var(--text-muted); background: transparent; }
    .nav-btn-secondary:hover { color: var(--primary); background: var(--primary-light); }
    .nav-links { display: flex; gap: 8px; }
    .nav-links a { text-decoration: none; }

    /* Layout Grid */
    .page-layout {
        max-width: 1200px;
        margin: 40px auto;
        padding: 0 24px;
        display: grid;
        grid-template-columns: 1fr 350px;
        gap: 30px;
        align-items: start;
    }

    /* Article Content */
    .article-container {
        width: 100%;
        background: white;
        border-radius: 24px;
        box-shadow: var(--shadow-md);
        overflow: hidden;
        position: relative;
    }
    .article-header { padding: 40px 0 20px; text-align: center; }
    .article-title { font-size: 2.5rem; font-weight: 800; line-height: 1.2; margin-bottom: 16px; color: var(--text-main); letter-spacing: -0.02em; padding: 0 20px; }
    .article-meta { display: flex; justify-content: center; gap: 20px; color: var(--text-muted); font-size: 0.95rem; margin-bottom: 24px; align-items: center; }
    .article-category { color: var(--primary); font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; font-size: 0.85rem; margin-bottom: 10px; display: inline-block; }
    .article-image { width: 100%; height: auto; max-height: 600px; object-fit: contain; border-radius: 16px; margin-bottom: 40px; background: #f3f4f6; box-shadow: var(--shadow-md); }
    
    .article-content { 
        font-family: 'Merriweather', serif; 
        font-size: 1.15rem; 
        line-height: 1.9; 
        color: #1f2937; 
        margin-bottom: 40px; 
        padding: 0 40px;
    }

    /* Sidebar */
    .sidebar {
        position: sticky;
        top: 100px;
    }
    
    .sidebar-widget {
        background: white;
        border-radius: 16px;
        padding: 24px;
        border: 1px solid var(--border);
        margin-bottom: 24px;
        box-shadow: var(--shadow-sm);
    }
    
    .widget-title {
        font-size: 1.1rem;
        font-weight: 700;
        margin-bottom: 16px;
        padding-bottom: 12px;
        border-bottom: 2px solid var(--bg-body);
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .widget-title i { color: var(--primary); }
    
    .mini-card {
        display: flex;
        gap: 12px;
        margin-bottom: 16px;
        text-decoration: none;
        color: inherit;
        transition: transform 0.2s;
    }
    .mini-card:last-child { margin-bottom: 0; }
    .mini-card:hover { transform: translateX(5px); }
    .mini-card:hover .mini-head { color: var(--primary); }
    
    .mini-img {
        width: 80px;
        height: 60px;
        border-radius: 8px;
        object-fit: cover;
        background: var(--bg-body);
        flex-shrink: 0;
    }
    
    .mini-content { flex: 1; }
    .mini-cat { font-size: 0.7rem; color: var(--primary); font-weight: 600; text-transform: uppercase; display: block; margin-bottom: 4px; }
    .mini-head { font-size: 0.9rem; font-weight: 600; line-height: 1.4; color: var(--text-main); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; transition: color 0.2s; }
    .mini-date { font-size: 0.75rem; color: var(--text-muted); margin-top: 4px; display: block; }

    /* Related News */
    .related-section { 
        margin-top: 40px; 
        padding: 0 40px 40px; 
    }
    
    .related-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); /* Responsive columns */
        gap: 20px;
    }
    
    .related-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.05);
      transition: transform 0.3s ease;
      text-decoration: none;
      color: inherit;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    .related-img {
        width: 100%;
        height: 180px;
        object-fit: cover;
        background: #eee;
    }
    .related-content { padding: 20px; flex: 1; display: flex; flex-direction: column; }
    .related-cat { color: var(--primary); font-size: 0.8rem; font-weight: 700; text-transform: uppercase; margin-bottom: 8px; display: block; }
    .related-head { font-size: 1.1rem; font-weight: 700; margin-bottom: 10px; line-height: 1.4; flex: 1; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
    .related-date { color: var(--text-muted); font-size: 0.85rem; margin-top: auto; }

    @media (max-width: 1024px) {
        .page-layout { grid-template-columns: 1fr; }
        .sidebar { position: static; margin-top: 40px; }
        .article-content { padding: 0 24px; }
        .related-section { padding: 0 24px 40px; }
        /* Fix overflow on mobile */
        .related-grid {
             grid-template-columns: 1fr; /* Single column on mobile */
        }
        .related-card {
            display: flex; /* Horizontal card on mobile for better space usage */
            height: auto;
            align-items: center;
        }
        .related-img {
            width: 100px;
            height: 100px;
            min-width: 100px;
        }
    }

    .article-content p { margin-bottom: 1.5em; }
    .article-content img { max-width: 100%; border-radius: 12px; margin: 20px 0; }
    .article-content h2 { margin-top: 1.5em; margin-bottom: 0.5em; font-size: 1.8rem; font-family: 'Inter', sans-serif; font-weight: 700; }
    .article-content h3 { margin-top: 1.2em; margin-bottom: 0.5em; font-size: 1.5rem; font-family: 'Inter', sans-serif; font-weight: 600; }
    .article-content ul, .article-content ol { margin-bottom: 1.5em; padding-left: 1.5em; }
    .article-content blockquote { border-left: 4px solid var(--primary); padding-left: 20px; margin: 30px 0; font-style: italic; color: #4b5563; font-size: 1.25rem; background: #f9fafb; padding: 20px; border-radius: 0 12px 12px 0; }
    
    .article-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 40px; padding-top: 20px; border-top: 1px solid var(--border); }
    .tag { background: #f3f4f6; color: #4b5563; padding: 6px 14px; border-radius: 100px; font-size: 0.9rem; text-decoration: none; transition: all 0.2s; font-family: 'Inter', sans-serif; }
    .tag:hover { background: var(--primary-light); color: var(--primary); }

    /* Share Buttons */
    .share-container {
        display: flex; gap: 12px; margin-top: 30px; justify-content: center;
    }
    .share-btn {
        width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center;
        border: 1px solid var(--border); background: white; color: var(--text-muted); cursor: pointer; transition: all 0.2s;
        font-size: 1.1rem;
    }
    .share-btn:hover { transform: translateY(-3px); color: var(--primary); border-color: var(--primary); }

    /* Footer */
    .news-footer { background: #1f2937; color: var(--text-muted); text-align: center; padding: 40px 24px; margin-top: 80px; }
    .news-footer p { color: #9ca3af; }

    /* News Ticker */
    .news-ticker-container {
        background: #1f2937;
        color: white;
        display: flex;
        align-items: center;
        overflow: hidden;
        height: 40px;
        position: relative;
        border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .ticker-label {
        background: #ef4444;
        color: white;
        padding: 0 16px;
        height: 100%;
        display: flex;
        align-items: center;
        font-weight: 700;
        font-size: 0.85rem;
        z-index: 2;
        box-shadow: 2px 0 10px rgba(0,0,0,0.2);
        white-space: nowrap;
        text-transform: uppercase;
    }

    .ticker-wrapper {
        flex: 1;
        overflow: hidden;
        position: relative;
        height: 100%;
        display: flex;
        align-items: center;
    }

    .ticker-content {
        display: flex;
        white-space: nowrap;
        animation: ticker-scroll 40s linear infinite;
        padding-left: 20px;
    }

    .ticker-item {
        display: inline-block;
        padding: 0 20px;
        font-size: 0.9rem;
        color: #e5e7eb;
        text-decoration: none;
        transition: color 0.2s;
        border-right: 1px solid rgba(255,255,255,0.1);
        flex-shrink: 0;
    }

    .ticker-item:hover {
        color: #ef4444;
    }

    .ticker-wrapper:hover .ticker-content {
        animation-play-state: paused;
    }

    @keyframes ticker-scroll {
        0% { transform: translate3d(0, 0, 0); }
        100% { transform: translate3d(-50%, 0, 0); }
    }

    @media (max-width: 768px) {
        /* Navbar Mobile */
        .nav-container { padding: 0 16px; }
        .nav-logo-text h1 { font-size: 1rem; }
        .nav-logo-text span { display: none; }
        .nav-logo-icon { width: 32px; height: 32px; font-size: 1rem; }
        #user-name { display: none !important; }
        .nav-btn { padding: 6px 12px; font-size: 0.85rem; }

        /* Article Mobile */
        .article-title { font-size: 1.8rem; padding: 0 10px; }
        .article-image { max-height: 350px; }
        .article-content { padding: 0 16px; font-size: 1rem; }
        .article-meta { flex-direction: column; gap: 8px; }

        /* Ticker Mobile */
        .news-ticker-container { height: 50px; flex-direction: row; }
        .ticker-label { display: none !important; }
        .ticker-wrapper { height: 100%; width: 100%; background: #1f2937; }
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar">
    <div class="nav-container">
      <a href="/bloq" class="nav-logo">
        <div class="nav-logo-icon">
          <i class="fas fa-graduation-cap"></i>
        </div>
        <div class="nav-logo-text">
          <h1>ƒ∞mtahan Bloq</h1>
          <span>T…ôhsil, inki≈üaf v…ô uƒüur √º√ß√ºn faydalƒ± m…ôqal…ôl…ôr</span>
        </div>
      </a>
      
      <div class="nav-links">
        <a href="/" class="nav-btn nav-btn-secondary">Ana S…ôhif…ô</a>
      </div>
    </div>
  </nav>

  <!-- News Ticker -->
  <div class="news-ticker-container">
      <div class="ticker-label"><i class="fas fa-bolt" style="margin-right:8px;"></i> Son M…ôqal…ôl…ôr</div>
      <div class="ticker-wrapper">
         <div class="ticker-content" id="newsTickerContent">
           <span style="padding:0 20px;">M…ôqal…ôl…ôr y√ºkl…ônir...</span>
         </div>
      </div>
  </div>

  <!-- Main Content Layout -->
  <div class="page-layout">
    <!-- Left Column: Article -->
    <article class="article-container">
        <div id="loading" style="display: none;">
            <i class="fas fa-spinner fa-spin fa-3x" style="color: var(--primary);"></i>
            <p style="margin-top: 20px; color: var(--text-muted);">Y√ºkl…ônir...</p>
        </div>
        
        <div id="articleBody" style="display: block;">
            <div class="article-header">
                <div class="article-category" id="newsCategory">Texnoloji Yenilikl…ôr</div>
                <h1 class="article-title" id="newsTitle">‚ö°Ô∏è Batareyasƒ±z G…ôl…ôc…ôk: "Havadan Enerji" Yƒ±ƒüan Cihazlar Yaradƒ±ldƒ±!</h1>
                <div class="article-meta" id="newsMeta"><i class="fas fa-calendar-alt" style="margin-right:8px"></i> 10 Yanvar 2026</div>
            </div>
            
            <img id="newsCover" class="article-image" src="https://imtahan.site/assets/logo.png" alt="‚ö°Ô∏è Batareyasƒ±z G…ôl…ôc…ôk: "Havadan Enerji" Yƒ±ƒüan Cihazlar Yaradƒ±ldƒ±!">
            
            <div class="article-content" id="newsContent"><p data-path-to-node="2">T…ôs…ôvv√ºr edin ki, telefonunuzun enerjisi he√ß vaxt bitmir v…ô siz onu he√ß vaxt adapter…ô taxmƒ±rsƒ±nƒ±z. Bu artƒ±q elmi-fantastika deyil. Massa√ßusets Texnologiya ƒ∞nstitutunun (MIT) aliml…ôri …ôtrafdakƒ± <b data-path-to-node="2" data-index-in-node="193">Wi-Fi siqnallarƒ±nƒ± elektrik enerjisin…ô √ßevir…ôn</b> yeni n√∂v "reksantena" (rectifying antenna) hazƒ±rlayƒ±blar.</p><h3 data-path-to-node="3">üõ∞Ô∏è Bu Texnologiya Nec…ô ƒ∞≈ül…ôyir?</h3><p data-path-to-node="4">Bu cihaz, h…ôr yerd…ô olan Wi-Fi, Bluetooth v…ô mobil ≈ü…ôb…ôk…ô dalƒüalarƒ±nƒ± tutur. Cihazƒ±n i√ßind…ôki ultra-nazik (atom qalƒ±nlƒ±ƒüƒ±nda) material bu dalƒüalarƒ± udur v…ô onlarƒ± birba≈üa sabit c…ôr…ôyana (DC) √ßevirir.</p><p data-path-to-node="5"><b data-path-to-node="5" data-index-in-node="0">X…ôb…ôrin …ôn maraqlƒ± m…ôqamlarƒ±:</b></p><ul data-path-to-node="6"><li><p data-path-to-node="6,0,0"><b data-path-to-node="6,0,0" data-index-in-node="0">Sonsuz Enerji:</b> Cihazlar he√ß bir kabell…ô birl…ô≈üm…ôd…ôn, sad…ôc…ô havada m√∂vcud olan dalƒüalarla qidalanƒ±r.</p></li><li><p data-path-to-node="6,1,0"><b data-path-to-node="6,1,0" data-index-in-node="0">Ekoloji ƒ∞nqilab:</b> Bu texnologiya g…ôl…ôc…ôkd…ô milyardlarla litium-ion batareyanƒ±n zibilxanaya atƒ±lmasƒ±nƒ±n qar≈üƒ±sƒ±nƒ± ala bil…ôr.</p></li><li><p data-path-to-node="6,2,0"><b data-path-to-node="6,2,0" data-index-in-node="0">H…ôr Yer…ô Uyƒüun:</b> Material o q…ôd…ôr elastikdir ki, onu divar kaƒüƒ±zlarƒ±na, geyiml…ôr…ô v…ô ya tibbi implantlara yerl…ô≈üdirm…ôk m√ºmk√ºnd√ºr.</p></li></ul><hr data-path-to-node="7"><h3 data-path-to-node="8">üß† Niy…ô Bu G√ºn√ºn ∆èsas X…ôb…ôridir?</h3><p data-path-to-node="9">Aliml…ôr bildirirl…ôr ki, bu texnologiya x√ºsusil…ô "∆è≈üyalarƒ±n ƒ∞nterneti" (IoT) d√∂vr√ºnd…ô inqilab ed…ôc…ôk. M…ôs…ôl…ôn, evinizd…ôki b√ºt√ºn sensorlar, aƒüƒ±llƒ± saatlar v…ô ki√ßik elektron cihazlar "havadan qidalanaraq" ill…ôrl…ô fasil…ôsiz i≈ül…ôy…ôc…ôk. Artƒ±q "telefonumun enerjisi bitdi" c√ºml…ôsi tarix…ô qarƒ±≈üa bil…ôr!</p></div>
            
            <div class="article-tags" id="newsTags"><a href="/bloq" class="tag">#mobil</a><a href="/bloq" class="tag">#telefon</a><a href="/bloq" class="tag">#batareya</a><a href="/bloq" class="tag">#enerji</a><a href="/bloq" class="tag">#yenilik</a><a href="/bloq" class="tag">#texnologiya</a><a href="/bloq" class="tag">#Wi-Fi</a><a href="/bloq" class="tag">#elektrik</a><a href="/bloq" class="tag">#xiaomi</a><a href="/bloq" class="tag">#ƒ∞phone</a></div>

            <div class="share-container">
                <button class="share-btn" onclick="shareArticle('facebook')" title="Facebook"><i class="fab fa-facebook-f"></i></button>
                <button class="share-btn" onclick="shareArticle('twitter')" title="Twitter"><i class="fab fa-twitter"></i></button>
                <button class="share-btn" onclick="shareArticle('linkedin')" title="LinkedIn"><i class="fab fa-linkedin-in"></i></button>
                <button class="share-btn" onclick="shareArticle('copy')" title="Linki kopyala"><i class="fas fa-link"></i></button>
            </div>
        </div>

        <!-- Related News (Inside Card) -->
        <section class="related-section" id="relatedSection" style="display: none; border-top: 1px solid var(--border); padding-top: 40px;">
            <h3 class="related-title">Ox≈üar M…ôqal…ôl…ôr</h3>
            <div class="related-grid" id="relatedGrid"></div>
        </section>
    </article>

    <!-- Right Column: Sidebar -->
    <aside class="sidebar">
        <!-- Trend News Widget -->
        <div class="sidebar-widget" id="trendSection" style="display: none;">
            <h3 class="widget-title"><i class="fas fa-fire"></i> √áox Oxunanlar</h3>
            <div id="trendGrid">
                <!-- Trend items injected here -->
            </div>
        </div>

        <!-- Latest News Widget (Optional/Static for now) -->
        <!-- Categories Widget Removed -->
    </aside>
  </div>

  <!-- Footer -->
  <footer class="news-footer">
    <div class="nav-container" style="flex-direction: column;">
      <div style="display: flex; align-items: center; justify-content: center; gap: 16px; margin-bottom: 20px;">
        <div class="nav-logo-icon" style="width: 40px; height: 40px; font-size: 1.2rem;">
          <i class="fas fa-newspaper"></i>
        </div>
        <div class="nav-logo-text" style="text-align: left;">
          <h1 style="color: white;">ƒ∞mtahan</h1>
          <span style="color: #9ca3af;">T…ôhsil Platformasƒ±</span>
        </div>
      </div>
      <div style="margin-bottom: 20px;">
          <a href="https://www.instagram.com/ixeberler" target="_blank" style="color: #e1306c; text-decoration: none; font-size: 1.1rem; display: inline-flex; align-items: center; gap: 8px; font-weight: 600; background: rgba(255,255,255,0.05); padding: 8px 16px; border-radius: 50px; transition: background 0.2s;">
              <i class="fab fa-instagram" style="font-size: 1.3rem;"></i> ixeberler
          </a>
      </div>
      <p>&copy; 2026 ƒ∞mtahan. B√ºt√ºn h√ºquqlar qorunur.</p>
    </div>
  </footer>

  <script>
    // Firebase Configuration
    const firebaseConfig = {
        apiKey: "AIzaSyAak_eY0WNpY7cqAEuWEBG9wBDhg1NPw_0",
        authDomain: "imtahansistemi-17659.firebaseapp.com",
        projectId: "imtahansistemi-17659",
        storageBucket: "imtahansistemi-17659.firebasestorage.app",
        messagingSenderId: "715396853166",
        appId: "1:715396853166:web:9829b853e5e572de4d2c3f"
    };

    // Diagnostics helper
    const diag = {
        logs: [],
        log: function(msg, data) {
            const entry = `[${new Date().toLocaleTimeString()}] ${msg} ${data ? JSON.stringify(data) : ''}`;
            console.log(entry);
            this.logs.push(entry);
            if (window.location.search.includes('debug=1')) {
                let panel = document.getElementById('diagPanel');
                if (!panel) {
                    panel = document.createElement('div');
                    panel.id = 'diagPanel';
                    panel.style = 'position:fixed; bottom:0; right:0; background:rgba(0,0,0,0.8); color:white; padding:10px; font-family:monospace; font-size:12px; max-height:200px; overflow:auto; z-index:9999; width:100%; pointer-events:none;';
                    document.body.appendChild(panel);
                }
                panel.innerHTML = this.logs.join('<br>');
                panel.scrollTop = panel.scrollHeight;
            }
        }
    };
    window.onerror = function(msg, url, line) {
        diag.log(`GLOBAL ERROR: ${msg} at ${url}:${line}`);
    };

    // Initialize Firebase
    if (!firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
    }
    const db = firebase.firestore();

    // Helper functions (copied from news-app.js for standalone view)
    const LOCAL_NEWS_KEY = 'imtahan_news_local';
    function readLocalNews() {
        try { return JSON.parse(localStorage.getItem(LOCAL_NEWS_KEY) || '[]'); } catch { return []; }
    }
    
    function getNewsLink(item) {
        if (!item) return '#';
        const slug = item.slug || (item.title ? slugify(item.title) : null);
        if (slug) {
            return '/bloq/' + slug;
        }
        return '/bloq/view.html?id=' + item.id;
    }
    function formatDate(dateStr) {
        if (!dateStr) return '';
        try {
            // Handle Firestore Timestamp
            if (dateStr && typeof dateStr.toDate === 'function') {
                dateStr = dateStr.toDate();
            }
            const date = new Date(dateStr);
            if (isNaN(date.getTime())) return dateStr; 
            const months = ['Yanvar', 'Fevral', 'Mart', 'Aprel', 'May', 'ƒ∞yun', 'ƒ∞yul', 'Avqust', 'Sentyabr', 'Oktyabr', 'Noyabr', 'Dekabr'];
            return `${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}`;
        } catch (e) {
            return dateStr || '';
        }
    }
    function buildDescription(item) {
        var t = item.excerpt || item.content || '';
        var s = t.replace(/<[^>]+>/g, ' ').replace(/\s+/g, ' ').trim();
        if (s.length > 180) s = s.slice(0, 180);
        return s;
    }
    function setMetaName(name, content) {
        var m = document.querySelector('meta[name="' + name + '"]');
        if (!m) {
            m = document.createElement('meta');
            m.setAttribute('name', name);
            document.head.appendChild(m);
        }
        m.setAttribute('content', content || '');
    }
    function setMetaProp(prop, content) {
        var m = document.querySelector('meta[property="' + prop + '"]');
        if (!m) {
            m = document.createElement('meta');
            m.setAttribute('property', prop);
            document.head.appendChild(m);
        }
        m.setAttribute('content', content || '');
    }
    function appendMetaProp(prop, content) {
        var m = document.createElement('meta');
        m.setAttribute('property', prop);
        m.setAttribute('content', content || '');
        document.head.appendChild(m);
    }
    function setLinkRel(rel, href) {
        var l = document.querySelector('link[rel="' + rel + '"]');
        if (!l) {
            l = document.createElement('link');
            l.setAttribute('rel', rel);
            document.head.appendChild(l);
        }
        l.setAttribute('href', href || '');
    }
    function setJsonLd(data) {
        var s = document.querySelector('script[type="application/ld+json"]');
        if (!s) {
            s = document.createElement('script');
            s.type = 'application/ld+json';
            document.head.appendChild(s);
        }
        s.textContent = JSON.stringify(data);
    }

    function slugify(str) {
        return (str || '')
            .toLowerCase()
            .replace(/ƒü/g,'g').replace(/…ô/g,'e').replace(/ƒ±/g,'i').replace(/√∂/g,'o').replace(/√ß/g,'c').replace(/≈ü/g,'s').replace(/√º/g,'u')
            .replace(/[^a-z0-9\s-]/g,'')
            .trim()
            .replace(/\s+/g,'-')
            .replace(/-+/g,'-')
            .slice(0, 120);
    }

    function setSeoTags(item) {
        var url = location.origin + getNewsLink(item);
        var desc = buildDescription(item);
        var image = (item.imageUrl && /^https?:\/\//.test(item.imageUrl)) ? item.imageUrl : 'https://imtahan.site/assets/logo.png';
        var modifiedIso = new Date().toISOString();
        try {
            if (item.updatedAt && item.updatedAt.toDate) {
                modifiedIso = item.updatedAt.toDate().toISOString();
            } else if (item.updatedAt) {
                const d = new Date(item.updatedAt);
                if (!isNaN(d.getTime())) modifiedIso = d.toISOString();
            }
        } catch (e) { console.warn("Date error:", e); }

        var publishedIso = new Date().toISOString();
        try {
            if (item.date) {
                const d = new Date(item.date);
                if (!isNaN(d.getTime())) publishedIso = d.toISOString();
            }
        } catch (e) { console.warn("Date error:", e); }
        setMetaName('robots', 'index,follow');
        setMetaName('description', desc);
        if (item.tags && item.tags.length) setMetaName('keywords', item.tags.join(','));
        setMetaProp('og:type', 'article');
        setMetaProp('og:url', url);
        setMetaProp('og:title', item.title || '');
        setMetaProp('og:description', desc);
        setMetaProp('og:image', image);
        setMetaProp('og:image:alt', item.title || '');
        setMetaProp('og:site_name', 'ƒ∞mtahan Bloq');
        setMetaProp('og:locale', 'az_AZ');
        setMetaProp('article:published_time', publishedIso);
        setMetaProp('article:modified_time', modifiedIso);
        setMetaProp('article:section', item.category || 'Bloq');
        if (item.tags && item.tags.length) item.tags.forEach(function(t){ appendMetaProp('article:tag', t); });
        setMetaName('twitter:card', 'summary_large_image');
        setMetaName('twitter:url', url);
        setMetaName('twitter:title', item.title || '');
        setMetaName('twitter:description', desc);
        setMetaName('twitter:image', image);
        setMetaName('twitter:image:alt', item.title || '');
        setLinkRel('canonical', url);
        var jsonLd = {
            "@context": "https://schema.org",
            "@type": "BlogPosting",
            "headline": item.title || '',
            "description": desc,
            "image": [image],
            "datePublished": publishedIso,
            "dateModified": modifiedIso,
            "author": [{
                "@type": "Organization",
                "name": "ƒ∞mtahan Bloq",
                "url": location.origin
            }],
            "publisher": {
                "@type": "Organization",
                "name": "ƒ∞mtahan Bloq",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://imtahan.site/assets/logo.png"
                }
            },
            "articleSection": item.category || 'Bloq',
            "keywords": item.tags && item.tags.length ? item.tags.join(',') : '',
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": url
            }
        };
        var breadcrumbs = {
            "@context": "https://schema.org",
            "@type": "BreadcrumbList",
            "itemListElement": [
                {
                    "@type": "ListItem",
                    "position": 1,
                    "name": "Ana S…ôhif…ô",
                    "item": location.origin + "/"
                },
                {
                    "@type": "ListItem",
                    "position": 2,
                    "name": "Bloq",
                    "item": location.origin + "/bloq"
                }
            ].concat(item.category ? [{
                "@type": "ListItem",
                "position": 3,
                "name": item.category,
                "item": location.origin + "/bloq?category=" + encodeURIComponent(item.category)
            }] : []).concat([{
                "@type": "ListItem",
                "position": item.category ? 4 : 3,
                "name": item.title || '',
                "item": url
            }])
        };
        setJsonLd([jsonLd, breadcrumbs]);
    }

    async function loadArticle() {
        diag.log("Loading article...");
        
        const urlParams = new URLSearchParams(window.location.search);
        let id = urlParams.get('id');
        let slug = urlParams.get('slug'); 
        
        if (slug) {
            slug = slugify(decodeURIComponent(slug)).trim();
        }
        
        diag.log("Params extracted:", { id, slug });
        
        if (!id && !slug) {
            const parts = window.location.pathname.split('/').filter(p => !!p);
            diag.log("Path parts for slug extraction:", parts);
            
            // URL /bloq/slug formatƒ±nda olanda 'bloq' hiss…ôsini √ßƒ±xƒ±rƒ±q
            if (parts.length >= 2 && parts[0] === 'bloq') {
                slug = parts[1].split('?')[0].split('#')[0];
            } else if (parts.length === 1 && parts[0] !== 'bloq') {
                slug = parts[0].split('?')[0].split('#')[0];
            }
            
            if (slug) {
                slug = slugify(decodeURIComponent(slug)).trim();
            }
            
            if (slug && (slug === 'view.html' || slug === 'index.html' || slug === 'bloq')) {
                slug = null;
            }
            
            if (slug) {
                diag.log("Extracted slug from path:", slug);
            }
        }
        
        // Ensure db is available
        if (typeof db === 'undefined') {
            diag.log("ERROR: Firestore 'db' is not defined!");
            document.getElementById('loading').innerHTML = '<p style="color:red; text-align:center; padding:20px;">Sistem x…ôtasƒ±: Veril…ônl…ôr bazasƒ± il…ô …ôlaq…ô qurulmadƒ±.</p>';
            return;
        }
        
        if (slug && !id) {
            if (window.history && window.history.replaceState && window.location.protocol !== 'file:') {
                const cleanSlug = slug.split('?')[0];
                const newPath = '/bloq/' + cleanSlug;
                if (window.location.pathname !== newPath) {
                   window.history.replaceState({path: newPath}, '', newPath);
                   diag.log("Updated URL state to:", newPath);
                }
            }
        }

        // Try to find in cache first for instant load
        let localItem = null;
        try {
            if (id) {
                localItem = readLocalNews().find(n => n.id === id);
            }
            if (!localItem) {
                const sessionCache = sessionStorage.getItem('news_list_cache');
                if (sessionCache) {
                    const parsed = JSON.parse(sessionCache);
                    localItem = id ? parsed.data.find(n => n.id === id) : (slug ? parsed.data.find(n => n.slug === slug) : null);
                }
            }
        } catch (e) { diag.log("Cache read error", e.message); }

        if (localItem) {
            diag.log("Found in cache, rendering immediately");
            renderArticle(localItem);
            loadRelatedNews(localItem.category, localItem.id);
            loadTrendNews(localItem.id);
        } else {
            diag.log("Not found in cache, waiting for Firestore...");
            loadTrendNews();
        }

        // Global timeout for Firestore
        const loadingTimeout = setTimeout(() => {
            if (document.getElementById('loading').style.display !== 'none') {
                diag.log("TIMEOUT: Firestore taking too long.");
                document.getElementById('loading').innerHTML = `
                    <div style="text-align:center; padding: 40px;">
                        <i class="fas fa-wifi-slash" style="font-size: 48px; color: #ccc; margin-bottom: 20px;"></i>
                        <p style="color: #666; font-size: 18px;">Baƒülantƒ± z…ôifdir v…ô ya x…ôb…ôr tapƒ±lmadƒ±.</p>
                        <div style="display:flex; gap:10px; justify-content:center; margin-top:20px;">
                            <a href="javascript:location.reload()" style="padding:10px 20px; background:var(--primary); color:white; border-radius:5px; text-decoration:none;">Yenid…ôn yoxla</a>
                            <a href="/bloq" style="padding:10px 20px; background:#f3f4f6; color:var(--text-main); border-radius:5px; text-decoration:none;">Bloqa qayƒ±t</a>
                        </div>
                    </div>
                `;
            }
        }, 20000);

        try {
            let articleData = null;
            
            // 1. Try Slug Query
            if (slug && !id) {
                try {
                    diag.log("Querying Firestore for slug:", slug);
                    const snap = await db.collection('news').where('slug','==',slug).limit(1).get();
                    if (!snap.empty) {
                        const d = snap.docs[0];
                        id = d.id;
                        articleData = { id: d.id, ...d.data() };
                        diag.log("Found by slug query", id);
                    } else {
                        diag.log("Slug query returned empty");
                    }
                } catch (e) {
                    diag.log("Slug query failed (missing index?)", e.message);
                }
            }
            
            // 2. Try Fallback Title Match (if slug query failed or no slug field)
            if (!articleData && slug && !id) {
                try {
                    diag.log("Trying fallback title-slug match (limit 200)...");
                    // Increased limit to 200 for better chance
                    const latestSnap = await db.collection('news').orderBy('date', 'desc').limit(200).get();
                    diag.log("Fallback search in docs count:", latestSnap.size);
                    const found = latestSnap.docs.find(d => {
                        const data = d.data();
                        return slugify(data.title) === slug || (data.slug === slug);
                    });
                    if (found) {
                        diag.log("Found article via fallback match!", found.id);
                        id = found.id;
                        articleData = { id: found.id, ...found.data() };
                    } else {
                        diag.log("Fallback match found nothing in latest 200");
                    }
                } catch (e) {
                    diag.log("Fallback match failed", e.message);
                    // If orderBy failed (index), try without it
                    try {
                        diag.log("Retrying fallback without orderBy...");
                        const snap2 = await db.collection('news').limit(200).get();
                        const found2 = snap2.docs.find(d => {
                            const data = d.data();
                            return slugify(data.title) === slug || (data.slug === slug);
                        });
                        if (found2) {
                            id = found2.id;
                            articleData = { id: found2.id, ...found2.data() };
                            diag.log("Found article via fallback (no orderBy)!", id);
                        }
                    } catch (e2) { diag.log("Fallback retry failed", e2.message); }
                }
            }
            
            // 3. Try Direct ID Query
            if (!articleData && id) {
                try {
                    diag.log("Querying Firestore for ID:", id);
                    const doc = await db.collection('news').doc(id).get();
                    if (doc.exists) {
                        articleData = { id: doc.id, ...doc.data() };
                        diag.log("Found by ID query");
                    } else {
                        diag.log("ID query returned non-existent doc");
                    }
                } catch (e) {
                    diag.log("ID query failed", e.message);
                }
            }

            // 4. Final Fallback to local data
            if (!articleData) {
                diag.log("Checking initial data fallback...");
                articleData = (typeof getInitialData === 'function' ? getInitialData().find(n => n.id === id || (slug && n.slug === slug)) : null);
            }

            if (!articleData) {
                diag.log("FINAL ERROR: Article not found anywhere.");
                clearTimeout(loadingTimeout);
                document.getElementById('loading').innerHTML = `
                    <div style="text-align:center; padding: 40px;">
                        <i class="fas fa-exclamation-circle" style="font-size: 48px; color: #ccc; margin-bottom: 20px;"></i>
                        <p style="color: #666; font-size: 18px;">M…ôqal…ô tapƒ±lmadƒ± v…ô ya silinib.</p>
                        <a href="/bloq" style="display:inline-block; margin-top:20px; padding:10px 20px; background:var(--primary); color:white; border-radius:5px; text-decoration:none;">Bloqa qayƒ±t</a>
                    </div>
                `;
                return;
            }

            // Update views
            if (articleData && articleData.id) {
                 try {
                     db.collection('news').doc(articleData.id).update({
                        views: firebase.firestore.FieldValue.increment(1)
                    });
                    articleData.views = (articleData.views || 0) + 1;
                    diag.log("Views incremented");
                 } catch(e) { diag.log("View increment error", e.message); }
            }

            clearTimeout(loadingTimeout);
            diag.log("Success! Rendering article.");
            renderArticle(articleData);
            loadRelatedNews(articleData.category, articleData.id);
            loadTrendNews(articleData.id);

        } catch (error) {
            clearTimeout(loadingTimeout);
            diag.log("CRITICAL ERROR in loadArticle", error.message);
            document.getElementById('loading').innerHTML = `<p style="color: red; text-align:center; padding:20px;">X…ôta ba≈ü verdi: ${error.message}</p>`;
        }
    }

    function renderArticle(item) {
        if (!item) return;
        console.log("Rendering article:", item.id);
        
        try {
            document.title = `${item.title || 'M…ôqal…ô'} ‚Äì ƒ∞mtahan Bloq`;
            setSeoTags(item);
        } catch (e) {
            console.error("SEO/Title error:", e);
        }
        
        try {
            document.getElementById('newsCategory').textContent = item.category || 'Bloq';
            document.getElementById('newsTitle').textContent = item.title || '';
            
            const metaDiv = document.getElementById('newsMeta');
            if (metaDiv) {
                metaDiv.innerHTML = `
                    <span><i class="far fa-calendar"></i> ${formatDate(item.date)}</span>
                    <span><i class="far fa-clock"></i> ${item.readTime || 3} d…ôq</span>
                    <span><i class="far fa-eye"></i> ${item.views || 0}</span>
                `;
            }

            if (item.imageUrl) {
                const img = document.getElementById('newsCover');
                if (img) {
                    img.src = item.imageUrl;
                    img.style.display = 'block';
                }
            }

            // Format content
            const content = item.content || item.excerpt || '';
            const contentDiv = document.getElementById('newsContent');
            if (contentDiv) {
                if (!content || content.trim() === '') {
                    contentDiv.innerHTML = '<p style="color:var(--text-muted); font-style:italic;">M…ôzmun yoxdur.</p>';
                } else if (!content.trim().startsWith('<')) {
                    contentDiv.innerHTML = content.split('\n').map(p => `<p>${p}</p>`).join('');
                } else {
                    contentDiv.innerHTML = content;
                }
            }

            // Tags rendering
            const tagsContainer = document.getElementById('newsTags');
            if (tagsContainer) {
                if (item.tags && item.tags.length > 0) {
                    tagsContainer.innerHTML = item.tags.map(tag => `<span class="tag">#${tag}</span>`).join('');
                    tagsContainer.style.display = 'flex';
                } else {
                    tagsContainer.style.display = 'none';
                }
            }

            document.getElementById('loading').style.display = 'none';
            document.getElementById('articleBody').style.display = 'block';
            console.log("Article rendered successfully.");
            
        } catch (e) {
            console.error("Render inner error:", e);
            document.getElementById('loading').innerHTML = `<p style="color: red; text-align:center; padding:20px;">G√∂st…ôrm…ô x…ôtasƒ±: ${e.message}</p>`;
        }
    }

    async function loadRelatedNews(category, currentId) {
        try {
            // CACHE: Ox≈üar x…ôb…ôrl…ôri cache-d…ôn oxuyaq
            const CACHE_KEY = `related_news_${category}`;
            const cached = sessionStorage.getItem(CACHE_KEY);
            let related = [];

            if (cached) {
                const parsed = JSON.parse(cached);
                // 30 d…ôqiq…ôlik cache
                if (Date.now() - parsed.timestamp < 30 * 60 * 1000) {
                    related = parsed.data;
                }
            }

            if (related.length === 0) {
                let query = db.collection('news')
                    .where('status', '==', 'published')
                    .where('category', '==', category);
                let snapshot;
                try {
                    snapshot = await query.orderBy('date', 'desc').limit(4).get();
                } catch (e) {
                    console.warn("Index missing for related query; falling back without orderBy:", e);
                    snapshot = await query.limit(4).get();
                }

                snapshot.forEach(doc => {
                    related.push({ id: doc.id, ...doc.data() });
                });

                // Save to cache
                if (related.length > 0) {
                    sessionStorage.setItem(CACHE_KEY, JSON.stringify({
                        timestamp: Date.now(),
                        data: related
                    }));
                }
            }

            // Filter out current article
            const filteredRelated = related.filter(item => item.id !== currentId).slice(0, 3);

            if (filteredRelated.length > 0) {
                const grid = document.getElementById('relatedGrid');
                grid.innerHTML = '';
                filteredRelated.forEach(item => {
                    grid.innerHTML += `
                        <a href="${getNewsLink(item)}" class="related-card" style="text-decoration: none;">
                            ${item.imageUrl ? `<img src="${item.imageUrl}" class="related-img" onerror="this.insertAdjacentHTML('beforebegin','<div class=&quot;related-img&quot; style=&quot;background: var(--gradient-1)&quot;></div>'); this.remove();">` : `<div class="related-img" style="background: var(--gradient-1)"></div>`}
                            <div class="related-content">
                                <span class="related-cat">${item.category}</span>
                                <h4 class="related-head">${item.title}</h4>
                                <span class="related-date"><i class="far fa-calendar"></i> ${formatDate(item.date)}</span>
                            </div>
                        </a>
                    `;
                });
                document.getElementById('relatedSection').style.display = 'block';
            }
        } catch (e) {
            console.warn("Related news error:", e);
        }
    }

    async function loadTrendNews(currentId) {
        try {
            // CACHE: Trend x…ôb…ôrl…ôri sessiya yadda≈üƒ±ndan oxuyaq ki, h…ôr s…ôhif…ôd…ô sorƒüu getm…ôsin
            const CACHE_KEY = 'trend_news_cache';
            const cached = sessionStorage.getItem(CACHE_KEY);
            let all = [];

            if (cached) {
                const parsed = JSON.parse(cached);
                // 15 d…ôqiq…ôlik cache
                if (Date.now() - parsed.timestamp < 15 * 60 * 1000) {
                    all = parsed.data;
                }
            }

            if (all.length === 0) {
                let query = db.collection('news').where('status', '==', 'published');
                let snapshot;
                try {
                    // Limit 10 to reduce reads
                    snapshot = await query.orderBy('date', 'desc').limit(10).get();
                } catch (e) {
                    console.warn("Index missing for trend query; falling back without orderBy:", e);
                    snapshot = await query.limit(10).get();
                }

                snapshot.forEach(doc => {
                    all.push({ id: doc.id, ...doc.data() });
                });

                // Save to cache
                if (all.length > 0) {
                    sessionStorage.setItem(CACHE_KEY, JSON.stringify({
                        timestamp: Date.now(),
                        data: all
                    }));
                }
            }

            const local = readLocalNews();
            const existing = new Set(all.map(n => n.id));
            const merged = [...local.filter(n => !existing.has(n.id)), ...all];

            // Render Ticker with all latest news
            renderTicker(merged);

            // Filter for trends (exclude current)
            const trendItems = merged.filter(item => item.id !== currentId);

            // Shuffle and pick 3
            trendItems.sort(() => 0.5 - Math.random());
            const trends = trendItems.slice(0, 3);

            if (trends.length > 0) {
                const grid = document.getElementById('trendGrid');
                if (grid) {
                    grid.innerHTML = '';
                    trends.forEach(item => {
                        grid.innerHTML += `
                            <a href="${getNewsLink(item)}" class="mini-card">
                                ${item.imageUrl ? `<img src="${item.imageUrl}" class="mini-img" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxIiBoZWlnaHQ9IjEiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IiM2MzY2ZjEiLz48L3N2Zz4='">` : `<div class="mini-img" style="background: var(--gradient-2)"></div>`}
                                <div class="mini-content">
                                    <span class="mini-cat">${item.category}</span>
                                    <h4 class="mini-head">${item.title}</h4>
                                    <span class="mini-date"><i class="far fa-eye"></i> √áox oxunan</span>
                                </div>
                            </a>
                        `;
                    });
                    document.getElementById('trendSection').style.display = 'block';
                }
            }
        } catch (e) {
            console.warn("Trend news error:", e);
            // Fallback for trends
            const allInitial = getInitialData();
            renderTicker(allInitial); // Fallback ticker
            
            const trends = allInitial.slice(0, 3);
            const grid = document.getElementById('trendGrid');
            if (grid) {
                grid.innerHTML = '';
                trends.forEach(item => {
                    grid.innerHTML += `
                            <a href="${getNewsLink(item)}" class="mini-card">
                                ${item.imageUrl ? `<img src="${item.imageUrl}" class="mini-img" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxIiBoZWlnaHQ9IjEiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IiM2MzY2ZjEiLz48L3N2Zz4='">` : `<div class="mini-img" style="background: var(--gradient-2)"></div>`}
                                <div class="mini-content">
                                    <span class="mini-cat">${item.category}</span>
                                    <h4 class="mini-head">${item.title}</h4>
                                    <span class="mini-date"><i class="far fa-eye"></i> √áox oxunan</span>
                                </div>
                            </a>
                    `;
                });
                document.getElementById('trendSection').style.display = 'block';
            }
        }
    }

    function renderTicker(news) {
        const tickerContent = document.getElementById('newsTickerContent');
        if (!tickerContent) return;

        if (!news || news.length === 0) {
            tickerContent.innerHTML = '';
            return;
        }

        let itemsToRender = news.slice(0, 10);
        if (itemsToRender.length < 5) {
            itemsToRender = [...itemsToRender, ...itemsToRender, ...itemsToRender];
        }

        const itemsHtml = itemsToRender.map(item => `
            <a href="${getNewsLink(item)}" class="ticker-item">
                ${item.category ? `<span style="color:var(--secondary); font-weight:bold; margin-right:5px;">[${item.category.toUpperCase()}]</span>` : ''}
                ${escapeHtml(item.title)}
            </a>
        `).join('');

        // Double content for seamless loop
        tickerContent.innerHTML = itemsHtml + itemsHtml;

        // Apply CSS Animation
        tickerContent.style.display = 'flex';
        tickerContent.style.width = 'max-content';
        tickerContent.style.animation = 'none'; 
        tickerContent.offsetHeight; // Reflow
        tickerContent.style.animation = 'ticker-scroll 40s linear infinite';
    }

    function escapeHtml(text) {
        if (!text) return '';
        return text
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&#039;");
    }

    function shareArticle(platform) {
        const url = encodeURIComponent(window.location.href);
        const title = encodeURIComponent(document.title);
        
        let shareUrl = '';
        if (platform === 'facebook') shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
        if (platform === 'twitter') shareUrl = `https://twitter.com/intent/tweet?url=${url}&text=${title}`;
        if (platform === 'linkedin') shareUrl = `https://www.linkedin.com/shareArticle?mini=true&url=${url}&title=${title}`;
        
        if (platform === 'copy') {
            navigator.clipboard.writeText(window.location.href);
            alert('Link kopyalandƒ±!');
            return;
        }
        
        window.open(shareUrl, '_blank', 'width=600,height=400');
    }

    function getInitialData() {
        return [
            {
                id: '1',
                title: 'Yeni T…ôdris Proqramƒ± T…ôsdiql…ôndi',
                excerpt: 'T…ôhsil Nazirliyi t…ôr…ôfind…ôn t…ôsdiql…ônmi≈ü yeni kurikulum standartlarƒ±...',
                content: 'Tam m…ôtn buradadƒ±r...',
                category: 'r…ôsmi',
                date: '2026-01-05',
                readTime: 3,
                imageUrl: ''
            }
            // ... truncated for brevity
        ];
    }

    document.addEventListener('DOMContentLoaded', loadArticle);
  </script>
</body>
</html>
