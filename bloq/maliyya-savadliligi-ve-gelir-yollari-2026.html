<!DOCTYPE html>
<html lang="az">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <base href="/">
    <title>ğŸ’¸ CibinizdÉ™ki Pulun DÉ™yÉ™rini NecÉ™ QorumalÄ±? 2026-cÄ± Ä°ldÉ™ AzÉ™rbaycanda Æn Effektiv 5 GÉ™lir Metodu â€“ Ä°mtahan Bloq</title>
    <meta name="description" content="AzÉ™rbaycanda 2026-cÄ± ildÉ™ pulun dÉ™yÉ™rini qorumaq vÉ™ passiv gÉ™lir É™ldÉ™ etmÉ™k yollarÄ±. Ä°nvestisiya, onlayn qazanc vÉ™ maliyyÉ™ azadlÄ±ÄŸÄ± Ã¼Ã§Ã¼n 5 qÄ±zÄ±l mÉ™slÉ™hÉ™t.">
    <meta name="robots" content="index,follow">
    <link rel="canonical" href="https://imtahan.site/bloq/maliyya-savadliligi-ve-gelir-yollari-2026">
    <meta property="og:title" content="ğŸ’¸ CibinizdÉ™ki Pulun DÉ™yÉ™rini NecÉ™ QorumalÄ±? 2026-cÄ± Ä°ldÉ™ AzÉ™rbaycanda Æn Effektiv 5 GÉ™lir Metodu â€“ Ä°mtahan Bloq">
    <meta property="og:description" content="AzÉ™rbaycanda 2026-cÄ± ildÉ™ pulun dÉ™yÉ™rini qorumaq vÉ™ passiv gÉ™lir É™ldÉ™ etmÉ™k yollarÄ±. Ä°nvestisiya, onlayn qazanc vÉ™ maliyyÉ™ azadlÄ±ÄŸÄ± Ã¼Ã§Ã¼n 5 qÄ±zÄ±l mÉ™slÉ™hÉ™t.">
    <meta property="og:image" content="https://imtahan.site/assets/logo.png">
    <meta property="og:image:alt" content="ğŸ’¸ CibinizdÉ™ki Pulun DÉ™yÉ™rini NecÉ™ QorumalÄ±? 2026-cÄ± Ä°ldÉ™ AzÉ™rbaycanda Æn Effektiv 5 GÉ™lir Metodu â€“ Ä°mtahan Bloq">
    <meta property="og:url" content="https://imtahan.site/bloq/maliyya-savadliligi-ve-gelir-yollari-2026">
    <meta property="og:type" content="article">
    <meta property="og:site_name" content="Ä°mtahan Bloq">
    <meta property="article:published_time" content="2026-01-11T09:32:50.606Z">
    <meta property="article:modified_time" content="2026-01-11T09:58:14.878Z">
    <meta property="article:section" content="MÉ™slÉ™hÉ™tlÉ™r">
    <meta property="article:tag" content="maliyyÉ™">
    <meta property="article:tag" content="azÉ™rbaycan">
    <meta property="article:tag" content="pul">
    <meta property="article:tag" content="qazanc">
    <meta property="article:tag" content="investisiya">
    <meta property="article:tag" content="biznes">
    <meta property="article:tag" content="gÉ™lir">
    <meta property="article:tag" content="onlayn">
    <meta property="article:tag" content="kurs">
    <meta property="article:tag" content="iqtisadiyyat">
    <meta property="article:tag" content="bank">
    <meta property="article:tag" content="sÉ™hm">
    <meta property="article:tag" content="kripto">
    <meta property="article:tag" content="qÉ™naÉ™t">
    <meta property="article:tag" content="bÃ¼dcÉ™">
    <meta property="article:tag" content="inkiÅŸaf">
    <meta property="article:tag" content="motivasiya">
    <meta property="article:tag" content="uÄŸur">
    <meta property="article:tag" content="2026">
    <meta property="article:tag" content="trend">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="ğŸ’¸ CibinizdÉ™ki Pulun DÉ™yÉ™rini NecÉ™ QorumalÄ±? 2026-cÄ± Ä°ldÉ™ AzÉ™rbaycanda Æn Effektiv 5 GÉ™lir Metodu â€“ Ä°mtahan Bloq">
    <meta name="twitter:description" content="AzÉ™rbaycanda 2026-cÄ± ildÉ™ pulun dÉ™yÉ™rini qorumaq vÉ™ passiv gÉ™lir É™ldÉ™ etmÉ™k yollarÄ±. Ä°nvestisiya, onlayn qazanc vÉ™ maliyyÉ™ azadlÄ±ÄŸÄ± Ã¼Ã§Ã¼n 5 qÄ±zÄ±l mÉ™slÉ™hÉ™t.">
    <meta name="twitter:image" content="https://imtahan.site/assets/logo.png">
    <script type="application/ld+json">
    [
      {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "headline": "ğŸ’¸ CibinizdÉ™ki Pulun DÉ™yÉ™rini NecÉ™ QorumalÄ±? 2026-cÄ± Ä°ldÉ™ AzÉ™rbaycanda Æn Effektiv 5 GÉ™lir Metodu",
        "description": "AzÉ™rbaycanda 2026-cÄ± ildÉ™ pulun dÉ™yÉ™rini qorumaq vÉ™ passiv gÉ™lir É™ldÉ™ etmÉ™k yollarÄ±. Ä°nvestisiya, onlayn qazanc vÉ™ maliyyÉ™ azadlÄ±ÄŸÄ± Ã¼Ã§Ã¼n 5 qÄ±zÄ±l mÉ™slÉ™hÉ™t.",
        "image": ["https://imtahan.site/assets/logo.png"],
        "datePublished": "2026-01-11T09:32:50.606Z",
        "dateModified": "2026-01-11T09:58:14.878Z",
        "author": {
          "@type": "Organization",
          "name": "Ä°mtahan Bloq",
          "url": "https://imtahan.site"
        },
        "publisher": {
          "@type": "Organization",
          "name": "Ä°mtahan Bloq",
          "logo": {
            "@type": "ImageObject",
            "url": "https://imtahan.site/assets/logo.png"
          }
        },
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://imtahan.site/bloq/maliyya-savadliligi-ve-gelir-yollari-2026"
        }
      },
      {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Ana SÉ™hifÉ™",
            "item": "https://imtahan.site/"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Bloq",
            "item": "https://imtahan.site/bloq"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": "ğŸ’¸ CibinizdÉ™ki Pulun DÉ™yÉ™rini NecÉ™ QorumalÄ±? 2026-cÄ± Ä°ldÉ™ AzÉ™rbaycanda Æn Effektiv 5 GÉ™lir Metodu",
            "item": "https://imtahan.site/bloq/maliyya-savadliligi-ve-gelir-yollari-2026"
          }
        ]
      }
    ]
    </script>
  <link rel="shortcut icon" href="/assets/logo.png" type="image/png">
  <link rel="icon" href="/assets/logo.png" type="image/png" sizes="32x32">
  <link rel="icon" href="/assets/logo.png" type="image/png" sizes="16x16">
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://imtahansistemi-17659.firebaseapp.com">
  <link rel="preconnect" href="https://firestore.googleapis.com">
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"></noscript>
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Merriweather:ital,wght@0,300;0,400;0,700;1,300&display=swap" rel="stylesheet">
  
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js" defer></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js" defer></script>
  
  <style>
    :root {
      --primary: #6366f1;
      --primary-dark: #4338ca;
      --primary-light: #e0e7ff;
      --secondary: #ec4899;
      --text-main: #1f2937;
      --text-muted: #525252;
      --bg-body: #f3f4f6;
      --bg-card: #ffffff;
      --border: #e5e7eb;
      --radius: 16px;
      --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
      --gradient-1: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-body);
      color: var(--text-main);
      line-height: 1.6;
      -webkit-font-smoothing: antialiased;
    }

    /* Navigation */
    .navbar {
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(12px);
      border-bottom: 1px solid var(--border);
      position: relative;
      z-index: 100;
      padding: 1rem 0;
    }
    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .nav-logo {
      display: flex;
      align-items: center;
      gap: 12px;
      text-decoration: none;
      color: var(--text-main);
    }
    .nav-logo-icon {
      width: 40px;
      height: 40px;
      background: var(--gradient-1);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 1.2rem;
    }
    .nav-logo-text h1 { font-size: 1.25rem; font-weight: 700; line-height: 1.2; }
    .nav-logo-text span { font-size: 0.8rem; color: var(--text-muted); font-weight: 500; }
    .nav-btn {
      padding: 10px 20px;
      border-radius: 12px;
      font-weight: 600;
      font-size: 0.95rem;
      transition: all 0.2s;
      cursor: pointer;
      text-decoration: none;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .nav-btn-secondary { color: var(--text-muted); background: transparent; }
    .nav-btn-secondary:hover { color: var(--primary-dark); background: var(--primary-light); }
    .nav-links { display: flex; gap: 8px; }
    .nav-links a { text-decoration: none; }

    /* Layout Grid */
    .page-layout {
        max-width: 1200px;
        margin: 40px auto;
        padding: 0 24px;
        display: grid;
        grid-template-columns: 1fr 350px;
        gap: 30px;
        align-items: start;
    }

    /* Article Content */
    .article-container {
        width: 100%;
        background: white;
        border-radius: 24px;
        box-shadow: var(--shadow-md);
        overflow: hidden;
        position: relative;
    }
    .article-header { padding: 40px 0 20px; text-align: center; }
    .article-title { font-size: 2.5rem; font-weight: 800; line-height: 1.2; margin-bottom: 16px; color: var(--text-main); letter-spacing: -0.02em; padding: 0 20px; }
    .article-meta { display: flex; justify-content: center; gap: 20px; color: var(--text-muted); font-size: 0.95rem; margin-bottom: 24px; align-items: center; }
    .article-category { color: var(--primary-dark); font-weight: 700; text-transform: uppercase; letter-spacing: 0.05em; font-size: 0.85rem; margin-bottom: 10px; display: inline-block; }
    .article-image { width: 100%; height: auto; max-height: 600px; object-fit: contain; border-radius: 16px; margin-bottom: 40px; background: #f3f4f6; box-shadow: var(--shadow-md); }
    
    .article-content { 
        font-family: 'Merriweather', serif; 
        font-size: 1.15rem; 
        line-height: 1.9; 
        color: #1f2937; 
        margin-bottom: 40px; 
        padding: 0 40px;
    }

    /* Sidebar */
    .sidebar {
        position: sticky;
        top: 100px;
    }
    
    .sidebar-widget {
        background: white;
        border-radius: 16px;
        padding: 24px;
        border: 1px solid var(--border);
        margin-bottom: 24px;
        box-shadow: var(--shadow-sm);
    }
    
    .widget-title {
        font-size: 1.1rem;
        font-weight: 700;
        margin-bottom: 16px;
        padding-bottom: 12px;
        border-bottom: 2px solid var(--bg-body);
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .widget-title i { color: var(--primary-dark); }
    
    .mini-card {
        display: flex;
        gap: 12px;
        margin-bottom: 16px;
        text-decoration: none;
        color: inherit;
        transition: transform 0.2s;
    }
    .mini-card:last-child { margin-bottom: 0; }
    .mini-card:hover { transform: translateX(5px); }
    .mini-card:hover .mini-head { color: var(--primary-dark); }
    
    .mini-img {
        width: 80px;
        height: 60px;
        border-radius: 8px;
        object-fit: cover;
        background: var(--bg-body);
        flex-shrink: 0;
    }
    
    .mini-content { flex: 1; }
    .mini-cat { font-size: 0.7rem; color: var(--primary-dark); font-weight: 600; text-transform: uppercase; display: block; margin-bottom: 4px; }
    .mini-head { font-size: 0.9rem; font-weight: 600; line-height: 1.4; color: var(--text-main); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; transition: color 0.2s; }
    .mini-date { font-size: 0.75rem; color: var(--text-muted); margin-top: 4px; display: block; }

    /* Related News */
    .related-section { 
        margin-top: 40px; 
        padding: 0 40px 40px; 
    }
    
    .related-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); /* Responsive columns */
        gap: 20px;
    }
    
    .related-card {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 4px 15px rgba(0,0,0,0.05);
      transition: transform 0.3s ease;
      text-decoration: none;
      color: inherit;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    .related-img {
        width: 100%;
        height: 180px;
        object-fit: cover;
        background: #eee;
    }
    .related-content { padding: 20px; flex: 1; display: flex; flex-direction: column; }
    .related-cat { color: var(--primary-dark); font-size: 0.8rem; font-weight: 700; text-transform: uppercase; margin-bottom: 8px; display: block; }
    .related-head { font-size: 1.1rem; font-weight: 700; margin-bottom: 10px; line-height: 1.4; flex: 1; display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
    .related-date { color: var(--text-muted); font-size: 0.85rem; margin-top: auto; }

    @media (max-width: 1024px) {
        .page-layout { grid-template-columns: 1fr; }
        .sidebar { position: static; margin-top: 40px; }
        .article-content { padding: 0 24px; }
        .related-section { padding: 0 24px 40px; }
        /* Fix overflow on mobile */
        .related-grid {
             grid-template-columns: 1fr; /* Single column on mobile */
        }
        .related-card {
            display: flex; /* Horizontal card on mobile for better space usage */
            height: auto;
            align-items: center;
        }
        .related-img {
            width: 100px;
            height: 100px;
            min-width: 100px;
        }
    }

    .article-content p { margin-bottom: 1.5em; }
    .article-content img { max-width: 100%; border-radius: 12px; margin: 20px 0; }
    .article-content h2 { margin-top: 1.5em; margin-bottom: 0.5em; font-size: 1.8rem; font-family: 'Inter', sans-serif; font-weight: 700; }
    .article-content h3 { margin-top: 1.2em; margin-bottom: 0.5em; font-size: 1.5rem; font-family: 'Inter', sans-serif; font-weight: 600; }
    .article-content ul, .article-content ol { margin-bottom: 1.5em; padding-left: 1.5em; }
    .article-content blockquote { border-left: 4px solid var(--primary); padding-left: 20px; margin: 30px 0; font-style: italic; color: #4b5563; font-size: 1.25rem; background: #f9fafb; padding: 20px; border-radius: 0 12px 12px 0; }
    
    .article-tags { display: flex; gap: 10px; flex-wrap: wrap; margin-top: 40px; padding-top: 20px; border-top: 1px solid var(--border); }
    .tag { background: #f3f4f6; color: #4b5563; padding: 6px 14px; border-radius: 100px; font-size: 0.9rem; text-decoration: none; transition: all 0.2s; font-family: 'Inter', sans-serif; }
    .tag:hover { background: var(--primary-light); color: var(--primary-dark); }

    /* Share Buttons */
    .share-container {
        display: flex; gap: 12px; margin-top: 30px; justify-content: center;
    }
    .share-btn {
        width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center;
        border: 1px solid var(--border); background: white; color: var(--text-muted); cursor: pointer; transition: all 0.2s;
        font-size: 1.1rem;
    }
    .share-btn:hover { transform: translateY(-3px); color: var(--primary); border-color: var(--primary); }

    /* Footer */
    .news-footer { background: #1f2937; color: var(--text-muted); text-align: center; padding: 40px 24px; margin-top: 80px; }
    .news-footer p { color: #9ca3af; }

    /* News Ticker */
    .news-ticker-container {
        background: #1f2937;
        color: white;
        display: flex;
        align-items: center;
        overflow: hidden;
        height: 40px;
        position: relative;
        border-bottom: 1px solid rgba(255,255,255,0.1);
    }

    .ticker-label {
        background: #d92d2d;
        color: white;
        padding: 0 16px;
        height: 100%;
        display: flex;
        align-items: center;
        font-weight: 700;
        font-size: 0.85rem;
        z-index: 2;
        box-shadow: 2px 0 10px rgba(0,0,0,0.2);
        white-space: nowrap;
        text-transform: uppercase;
    }

    .ticker-wrapper {
        flex: 1;
        overflow: hidden;
        position: relative;
        height: 100%;
        display: flex;
        align-items: center;
    }

    .ticker-content {
        display: flex;
        white-space: nowrap;
        animation: ticker-scroll 40s linear infinite;
        padding-left: 20px;
    }

    .ticker-item {
        display: inline-block;
        padding: 0 20px;
        font-size: 0.9rem;
        color: #e5e7eb;
        text-decoration: none;
        transition: color 0.2s;
        border-right: 1px solid rgba(255,255,255,0.1);
        flex-shrink: 0;
    }

    .ticker-item:hover {
        color: #ef4444;
    }

    .ticker-wrapper:hover .ticker-content {
        animation-play-state: paused;
    }

    @keyframes ticker-scroll {
        0% { transform: translate3d(0, 0, 0); }
        100% { transform: translate3d(-50%, 0, 0); }
    }

    @media (max-width: 768px) {
        /* Navbar Mobile */
        .nav-container { padding: 0 16px; }
        .nav-logo-text h1 { font-size: 1rem; }
        .nav-logo-text span { display: none; }
        .nav-logo-icon { width: 32px; height: 32px; font-size: 1rem; }
        #user-name { display: none !important; }
        .nav-btn { padding: 6px 12px; font-size: 0.85rem; }

        /* Article Mobile */
        .article-title { font-size: 1.8rem; padding: 0 10px; }
        .article-image { max-height: 350px; }
        .article-content { padding: 0 16px; font-size: 1rem; }
        .article-meta { flex-direction: column; gap: 8px; }

        /* Ticker Mobile */
        .news-ticker-container { height: 50px; flex-direction: row; }
        .ticker-label { display: none !important; }
        .ticker-wrapper { height: 100%; width: 100%; background: #1f2937; }
    }
  </style>
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar">
    <div class="nav-container">
      <a href="/bloq/index.html" class="nav-logo">
        <div class="nav-logo-icon">
          <i class="fas fa-graduation-cap"></i>
        </div>
        <div class="nav-logo-text">
          <h1>Ä°mtahan Bloq</h1>
          <span>TÉ™hsil, inkiÅŸaf vÉ™ uÄŸur Ã¼Ã§Ã¼n faydalÄ± mÉ™qalÉ™lÉ™r</span>
        </div>
      </a>
      
      <div class="nav-links">
        <a href="/" class="nav-btn nav-btn-secondary">Ana SÉ™hifÉ™</a>
      </div>
    </div>
  </nav>

  <!-- News Ticker -->
  <div class="news-ticker-container">
      <div class="ticker-label"><i class="fas fa-bolt" style="margin-right:8px;"></i> Son MÉ™qalÉ™lÉ™r</div>
      <div class="ticker-wrapper">
         <div class="ticker-content" id="newsTickerContent">
           <span style="padding:0 20px;">MÉ™qalÉ™lÉ™r yÃ¼klÉ™nir...</span>
         </div>
      </div>
  </div>

  <!-- Main Content Layout -->
  <div class="page-layout">
    <!-- Left Column: Article -->
    <article class="article-container">
        <div id="loading" style="display: none;">
            <i class="fas fa-spinner fa-spin fa-3x" style="color: var(--primary);"></i>
            <p style="margin-top: 20px; color: var(--text-muted);">YÃ¼klÉ™nir...</p>
        </div>
        
        <div id="articleBody" style="display: block;" data-id="0eKMSPUxDZ2HJg2uZWxa">
            <div class="article-header">
                <div class="article-category" id="newsCategory">MÉ™slÉ™hÉ™tlÉ™r</div>
                <h1 class="article-title" id="newsTitle">ğŸ’¸ CibinizdÉ™ki Pulun DÉ™yÉ™rini NecÉ™ QorumalÄ±? 2026-cÄ± Ä°ldÉ™ AzÉ™rbaycanda Æn Effektiv 5 GÉ™lir Metodu</h1>
                <div class="article-meta" id="newsMeta">
                            <span><i class="far fa-calendar"></i> 11 Yanvar 2026</span>
                            <span><i class="far fa-clock"></i> 3 dÉ™q</span>
                            <span><i class="far fa-eye"></i> 10</span>
                        </div>
            </div>
            
            <img id="newsCover" class="article-image" src="https://imtahan.site/assets/logo.png" alt="ğŸ’¸ CibinizdÉ™ki Pulun DÉ™yÉ™rini NecÉ™ QorumalÄ±? 2026-cÄ± Ä°ldÉ™ AzÉ™rbaycanda Æn Effektiv 5 GÉ™lir Metodu" fetchpriority="high">
            
            <div class="article-content" id="newsContent"><p>HamÄ±mÄ±z bilirik ki, artÄ±q sadÉ™cÉ™ maaÅŸla kifayÉ™tlÉ™nmÉ™k vÉ™ ya pulu yastÄ±q altÄ±nda saxlamaq dÃ¶vrÃ¼ keÃ§miÅŸdÉ™ qaldÄ±. MÃ¼asir dÃ¶vrdÉ™ maliyyÉ™ azadlÄ±ÄŸÄ± É™ldÉ™ etmÉ™k Ã¼Ã§Ã¼n pulla dÃ¼zgÃ¼n davranmaÄŸÄ± Ã¶yrÉ™nmÉ™k ÅŸÉ™rtdir. BÉ™s hazÄ±rkÄ± ÅŸÉ™raitdÉ™ azÉ™rbaycanlÄ± gÉ™nclÉ™r vÉ™ peÅŸÉ™karlar Ã¼Ã§Ã¼n É™n real qazanc yollarÄ± hansÄ±lardÄ±r? GÉ™lin, birlikdÉ™ baxaq.</p>

<h2 style="color: #6366f1; margin-top: 25px;">ğŸ“ˆ Ä°nflyasiyaya QarÅŸÄ± Qalxan: Ä°nvestisiya Haradan BaÅŸlanÄ±r?</h2>
<p>Pulun dÉ™yÉ™r itirmÉ™si hÉ™r kÉ™si dÃ¼ÅŸÃ¼ndÃ¼rÉ™n É™sas mÉ™sÉ™lÉ™dir. Bir Ã§ox insan "investisiya necÉ™ edilir?" sualÄ±na cavab axtarÄ±r. AzÉ™rbaycanda son illÉ™rdÉ™ sÉ™hm bazarÄ± vÉ™ istiqrazlar daha Ã§ox É™lÃ§atan olub. Yerli banklarÄ±n vÉ™ investisiya ÅŸirkÉ™tlÉ™rinin tÉ™klif etdiyi alÉ™tlÉ™ri araÅŸdÄ±raraq, kiÃ§ik bÃ¼dcÉ™ ilÉ™ belÉ™ investisiya dÃ¼nyasÄ±na addÄ±m ata bilÉ™rsiniz.</p>

<!-- Ä°nteraktiv Blok -->
<div style="background: #f3f4f6; border-left: 5px solid #6366f1; padding: 20px; margin: 30px 0; border-radius: 8px;">
    <h3 style="margin-top: 0;"><i class="fas fa-user-check"></i> Ã–zÃ¼nÃ¼ Yoxla: MaliyyÉ™ SavadlÄ±lÄ±ÄŸÄ±n HansÄ± SÉ™viyyÉ™dÉ™dir?</h3>
    <p>AÅŸaÄŸÄ±dakÄ± 3 suala "HÉ™" vÉ™ ya "Yox" cavabÄ± verin:</p>
    <ul>
        <li>AylÄ±q xÉ™rclÉ™rimi qeyd edirÉ™m.</li>
        <li>GÉ™lirimin É™n azÄ± 10%-ni kÉ™nara qoyuram.</li>
        <li>Ä°nflyasiyanÄ±n nÉ™ olduÄŸunu bilirÉ™m.</li>
    </ul>
    <p><strong>NÉ™ticÉ™:</strong> ÆgÉ™r cavablarÄ±nÄ±zÄ±n hamÄ±sÄ± "HÉ™"dirsÉ™, sÉ™n artÄ±q maliyyÉ™ azadlÄ±ÄŸÄ± yolundasan!</p>
</div>

<h2 style="color: #6366f1; margin-top: 25px;">ğŸ  DaÅŸÄ±nmaz Æmlak Yoxsa RÉ™qÉ™msal AktivlÉ™r?</h2>
<p>ÆnÉ™nÉ™vi olaraq AzÉ™rbaycanda daÅŸÄ±nmaz É™mlak É™n etibarlÄ± sahÉ™ sayÄ±lÄ±r. Lakin artÄ±q kriptovalyuta vÉ™ blokÃ§eyn texnologiyalarÄ± da diqqÉ™tdÉ™n kÉ™narda qalmÄ±r. ÆgÉ™r yÃ¼ksÉ™k riskÉ™ hazÄ±rsÄ±nÄ±zsa, rÉ™qÉ™msal aktivlÉ™r portfelinizin bir hissÉ™si ola bilÉ™r. Lakin burada "qÄ±zÄ±l qayda" var: AnlamadÄ±ÄŸÄ±nÄ±z sahÉ™yÉ™ pul yatÄ±rmayÄ±n!</p>

<h2 style="color: #6366f1; margin-top: 25px;">ğŸ’» EvdÉ™n Ã‡Ä±xmadan Dollarla Qazanmaq: Freelance Ä°mkanlarÄ±</h2>
<p>ÆgÉ™r bir bacarÄ±ÄŸÄ±nÄ±z varsa (dizayn, proqramlaÅŸdÄ±rma, kopiraytinq), yerli bazarla mÉ™hdudlaÅŸmayÄ±n. Onlayn qazanc imkanlarÄ± sayÉ™sindÉ™ qlobal platformalarda xidmÉ™t gÃ¶stÉ™rÉ™rÉ™k xarici valyutada gÉ™lir É™ldÉ™ edÉ™ bilÉ™rsiniz. Bu, hÉ™m dÉ™ sizin fÉ™rdi inkiÅŸaf yolunuzda É™n bÃ¶yÃ¼k sÄ±Ã§rayÄ±ÅŸ olacaq.</p>

<h2 style="color: #6366f1; margin-top: 25px;">ğŸ›¡ï¸ MaliyyÉ™ SavadlÄ±lÄ±ÄŸÄ±: QÉ™naÉ™t Deyil, Ä°darÉ™etmÉ™!</h2>
<p>Ã‡ox insan elÉ™ bilir ki, maliyyÉ™ savadlÄ±lÄ±ÄŸÄ± az xÉ™rclÉ™mÉ™kdir. ÆslindÉ™ isÉ™ bu, bÃ¼dcÉ™ planlamasÄ± vÉ™ xÉ™rclÉ™rin aÄŸÄ±llÄ± idarÉ™ edilmÉ™sidir. AylÄ±q gÉ™lirinizin É™n azÄ± 10-20%-ni ayÄ±raraq tÉ™hlÃ¼kÉ™sizlik yastÄ±ÄŸÄ± yaratmaq sizi gÃ¶zlÉ™nilmÉ™z iqtisadi dalÄŸalanmaradan qoruyacaq.</p>

<h2 style="color: #6366f1; margin-top: 25px;">NÉ™ticÉ™</h2>
<p>2026-cÄ± il imkanlarla dolu bir ildir. Ä°stÉ™r biznes qurmaq, istÉ™rsÉ™ dÉ™ passiv gÉ™lir mÉ™nbÉ™lÉ™ri yaratmaq istÉ™yin, É™sas mÉ™sÉ™lÉ™ mÉ™lumatlÄ± olmaqdÄ±r. Bu gÃ¼n atacaÄŸÄ±nÄ±z kiÃ§ik bir addÄ±m, gÉ™lÉ™cÉ™k maliyyÉ™ azadlÄ±ÄŸÄ±nÄ±zÄ±n tÉ™mÉ™li ola bilÉ™r.</p></div>
            
            <div class="article-tags" id="newsTags"><a href="/bloq" class="tag">#maliyyÉ™</a><a href="/bloq" class="tag">#azÉ™rbaycan</a><a href="/bloq" class="tag">#pul</a><a href="/bloq" class="tag">#qazanc</a><a href="/bloq" class="tag">#investisiya</a><a href="/bloq" class="tag">#biznes</a><a href="/bloq" class="tag">#gÉ™lir</a><a href="/bloq" class="tag">#onlayn</a><a href="/bloq" class="tag">#kurs</a><a href="/bloq" class="tag">#iqtisadiyyat</a><a href="/bloq" class="tag">#bank</a><a href="/bloq" class="tag">#sÉ™hm</a><a href="/bloq" class="tag">#kripto</a><a href="/bloq" class="tag">#qÉ™naÉ™t</a><a href="/bloq" class="tag">#bÃ¼dcÉ™</a><a href="/bloq" class="tag">#inkiÅŸaf</a><a href="/bloq" class="tag">#motivasiya</a><a href="/bloq" class="tag">#uÄŸur</a><a href="/bloq" class="tag">#2026</a><a href="/bloq" class="tag">#trend</a></div>

            <div class="share-container">
                <button class="share-btn" onclick="shareArticle('facebook')" title="Facebook"><i class="fab fa-facebook-f"></i></button>
                <button class="share-btn" onclick="shareArticle('twitter')" title="Twitter"><i class="fab fa-twitter"></i></button>
                <button class="share-btn" onclick="shareArticle('linkedin')" title="LinkedIn"><i class="fab fa-linkedin-in"></i></button>
                <button class="share-btn" onclick="shareArticle('copy')" title="Linki kopyala"><i class="fas fa-link"></i></button>
            </div>
        </div>

        <!-- Related News (Inside Card) -->
        <section class="related-section" id="relatedSection" style="display: none; border-top: 1px solid var(--border); padding-top: 40px;">
            <h3 class="related-title">OxÅŸar MÉ™qalÉ™lÉ™r</h3>
            <div class="related-grid" id="relatedGrid"></div>
        </section>
    </article>

    <!-- Right Column: Sidebar -->
    <aside class="sidebar">
        <!-- Trend News Widget -->
        <div class="sidebar-widget" id="trendSection" style="display: none;">
            <h3 class="widget-title"><i class="fas fa-fire"></i> Ã‡ox Oxunanlar</h3>
            <div id="trendGrid">
                <!-- Trend items injected here -->
            </div>
        </div>

        <!-- Latest News Widget (Optional/Static for now) -->
        <!-- Categories Widget Removed -->
    </aside>
  </div>

  <!-- Footer -->
  <footer class="news-footer">
    <div class="nav-container" style="flex-direction: column;">
      <div style="display: flex; align-items: center; justify-content: center; gap: 16px; margin-bottom: 20px;">
        <div class="nav-logo-icon" style="width: 40px; height: 40px; font-size: 1.2rem;">
          <i class="fas fa-newspaper"></i>
        </div>
        <div class="nav-logo-text" style="text-align: left;">
          <h1 style="color: white;">Ä°mtahan</h1>
          <span style="color: #9ca3af;">TÉ™hsil PlatformasÄ±</span>
        </div>
      </div>
      <div style="margin-bottom: 20px;">
          <a href="https://www.instagram.com/ixeberler" target="_blank" style="color: #e1306c; text-decoration: none; font-size: 1.1rem; display: inline-flex; align-items: center; gap: 8px; font-weight: 600; background: rgba(255,255,255,0.05); padding: 8px 16px; border-radius: 50px; transition: background 0.2s;">
              <i class="fab fa-instagram" style="font-size: 1.3rem;"></i> ixeberler
          </a>
      </div>
      <p>&copy; 2026 Ä°mtahan. BÃ¼tÃ¼n hÃ¼quqlar qorunur.</p>
    </div>
  </footer>

  <script>
    // Firebase Configuration
    const firebaseConfig = {
        apiKey: "AIzaSyAak_eY0WNpY7cqAEuWEBG9wBDhg1NPw_0",
        authDomain: "imtahansistemi-17659.firebaseapp.com",
        projectId: "imtahansistemi-17659",
        storageBucket: "imtahansistemi-17659.firebasestorage.app",
        messagingSenderId: "715396853166",
        appId: "1:715396853166:web:9829b853e5e572de4d2c3f"
    };

    // Diagnostics helper
    const diag = {
        logs: [],
        log: function(msg, data) {
            const entry = `[${new Date().toLocaleTimeString()}] ${msg} ${data ? JSON.stringify(data) : ''}`;
            console.log(entry);
            this.logs.push(entry);
            if (window.location.search.includes('debug=1')) {
                let panel = document.getElementById('diagPanel');
                if (!panel) {
                    panel = document.createElement('div');
                    panel.id = 'diagPanel';
                    panel.style = 'position:fixed; bottom:0; right:0; background:rgba(0,0,0,0.8); color:white; padding:10px; font-family:monospace; font-size:12px; max-height:200px; overflow:auto; z-index:9999; width:100%; pointer-events:none;';
                    document.body.appendChild(panel);
                }
                panel.innerHTML = this.logs.join('<br>');
                panel.scrollTop = panel.scrollHeight;
            }
        }
    };
    window.onerror = function(msg, url, line) {
        diag.log(`GLOBAL ERROR: ${msg} at ${url}:${line}`);
    };

    // Initialize Firebase
    let db;
    function initFirebase() {
        if (!firebase.apps.length) {
            firebase.initializeApp(firebaseConfig);
            // Enable offline persistence for better performance on mobile
            firebase.firestore().enablePersistence().catch((err) => {
                if (err.code == 'failed-precondition') {
                    console.warn('Persistence failed: Multiple tabs open');
                } else if (err.code == 'unimplemented') {
                    console.warn('Persistence failed: Browser not supported');
                }
            });
        }
        db = firebase.firestore();
    }

    // Helper functions (copied from news-app.js for standalone view)
    const LOCAL_NEWS_KEY = 'imtahan_news_local';
    function readLocalNews() {
        try { return JSON.parse(localStorage.getItem(LOCAL_NEWS_KEY) || '[]'); } catch { return []; }
    }
    
    function getNewsLink(item) {
        if (!item) return '#';
        const slug = item.slug || (item.title ? slugify(item.title) : null);
        if (slug) {
            return '/bloq/' + slug;
        }
        return '/bloq/view.html?id=' + item.id;
    }
    function formatDate(dateStr) {
        if (!dateStr) return '';
        try {
            // Handle Firestore Timestamp
            if (dateStr && typeof dateStr.toDate === 'function') {
                dateStr = dateStr.toDate();
            }
            const date = new Date(dateStr);
            if (isNaN(date.getTime())) return dateStr; 
            const months = ['Yanvar', 'Fevral', 'Mart', 'Aprel', 'May', 'Ä°yun', 'Ä°yul', 'Avqust', 'Sentyabr', 'Oktyabr', 'Noyabr', 'Dekabr'];
            return `${date.getDate()} ${months[date.getMonth()]} ${date.getFullYear()}`;
        } catch (e) {
            return dateStr || '';
        }
    }
    function buildDescription(item) {
        var t = item.excerpt || item.content || '';
        var s = t.replace(/<[^>]+>/g, ' ').replace(/\s+/g, ' ').trim();
        if (s.length > 180) s = s.slice(0, 180);
        return s;
    }
    function setMetaName(name, content) {
        var m = document.querySelector('meta[name="' + name + '"]');
        if (!m) {
            m = document.createElement('meta');
            m.setAttribute('name', name);
            document.head.appendChild(m);
        }
        m.setAttribute('content', content || '');
    }
    function setMetaProp(prop, content) {
        var m = document.querySelector('meta[property="' + prop + '"]');
        if (!m) {
            m = document.createElement('meta');
            m.setAttribute('property', prop);
            document.head.appendChild(m);
        }
        m.setAttribute('content', content || '');
    }
    function appendMetaProp(prop, content) {
        var m = document.createElement('meta');
        m.setAttribute('property', prop);
        m.setAttribute('content', content || '');
        document.head.appendChild(m);
    }
    function setLinkRel(rel, href) {
        var l = document.querySelector('link[rel="' + rel + '"]');
        if (!l) {
            l = document.createElement('link');
            l.setAttribute('rel', rel);
            document.head.appendChild(l);
        }
        l.setAttribute('href', href || '');
    }
    function setJsonLd(data) {
        var s = document.querySelector('script[type="application/ld+json"]');
        if (!s) {
            s = document.createElement('script');
            s.type = 'application/ld+json';
            document.head.appendChild(s);
        }
        s.textContent = JSON.stringify(data);
    }

    function slugify(str) {
        return (str || '')
            .toLowerCase()
            .replace(/ÄŸ/g,'g').replace(/É™/g,'e').replace(/Ä±/g,'i').replace(/Ã¶/g,'o').replace(/Ã§/g,'c').replace(/ÅŸ/g,'s').replace(/Ã¼/g,'u')
            .replace(/[^a-z0-9\s-]/g,'')
            .trim()
            .replace(/\s+/g,'-')
            .replace(/-+/g,'-')
            .slice(0, 120);
    }

    function setSeoTags(item) {
        var url = location.origin + getNewsLink(item);
        var desc = buildDescription(item);
        var image = (item.imageUrl && /^https?:\/\//.test(item.imageUrl)) ? item.imageUrl : 'https://imtahan.site/assets/logo.png';
        var modifiedIso = new Date().toISOString();
        try {
            if (item.updatedAt && item.updatedAt.toDate) {
                modifiedIso = item.updatedAt.toDate().toISOString();
            } else if (item.updatedAt) {
                const d = new Date(item.updatedAt);
                if (!isNaN(d.getTime())) modifiedIso = d.toISOString();
            }
        } catch (e) { console.warn("Date error:", e); }

        var publishedIso = new Date().toISOString();
        try {
            if (item.date) {
                const d = new Date(item.date);
                if (!isNaN(d.getTime())) publishedIso = d.toISOString();
            }
        } catch (e) { console.warn("Date error:", e); }
        setMetaName('robots', 'index,follow');
        setMetaName('description', desc);
        if (item.tags && item.tags.length) setMetaName('keywords', item.tags.join(','));
        setMetaProp('og:type', 'article');
        setMetaProp('og:url', url);
        setMetaProp('og:title', item.title || '');
        setMetaProp('og:description', desc);
        setMetaProp('og:image', image);
        setMetaProp('og:image:alt', item.title || '');
        setMetaProp('og:site_name', 'Ä°mtahan Bloq');
        setMetaProp('og:locale', 'az_AZ');
        setMetaProp('article:published_time', publishedIso);
        setMetaProp('article:modified_time', modifiedIso);
        setMetaProp('article:section', item.category || 'Bloq');
        if (item.tags && item.tags.length) item.tags.forEach(function(t){ appendMetaProp('article:tag', t); });
        setMetaName('twitter:card', 'summary_large_image');
        setMetaName('twitter:url', url);
        setMetaName('twitter:title', item.title || '');
        setMetaName('twitter:description', desc);
        setMetaName('twitter:image', image);
        setMetaName('twitter:image:alt', item.title || '');
        setLinkRel('canonical', url);
        var jsonLd = {
            "@context": "https://schema.org",
            "@type": "BlogPosting",
            "headline": item.title || '',
            "description": desc,
            "image": [image],
            "datePublished": publishedIso,
            "dateModified": modifiedIso,
            "author": [{
                "@type": "Organization",
                "name": "Ä°mtahan Bloq",
                "url": location.origin
            }],
            "publisher": {
                "@type": "Organization",
                "name": "Ä°mtahan Bloq",
                "logo": {
                    "@type": "ImageObject",
                    "url": "https://imtahan.site/assets/logo.png"
                }
            },
            "articleSection": item.category || 'Bloq',
            "keywords": item.tags && item.tags.length ? item.tags.join(',') : '',
            "mainEntityOfPage": {
                "@type": "WebPage",
                "@id": url
            }
        };
        var breadcrumbs = {
            "@context": "https://schema.org",
            "@type": "BreadcrumbList",
            "itemListElement": [
                {
                    "@type": "ListItem",
                    "position": 1,
                    "name": "Ana SÉ™hifÉ™",
                    "item": location.origin + "/"
                },
                {
                    "@type": "ListItem",
                    "position": 2,
                    "name": "Bloq",
                    "item": location.origin + "/bloq"
                }
            ].concat(item.category ? [{
                "@type": "ListItem",
                "position": 3,
                "name": item.category,
                "item": location.origin + "/bloq?category=" + encodeURIComponent(item.category)
            }] : []).concat([{
                "@type": "ListItem",
                "position": item.category ? 4 : 3,
                "name": item.title || '',
                "item": url
            }])
        };
        setJsonLd([jsonLd, breadcrumbs]);
    }

    async function loadArticle() {
        diag.log("Loading article...");
        
        const urlParams = new URLSearchParams(window.location.search);
        let id = urlParams.get('id');
        let slug = urlParams.get('slug'); 
        
        const articleBody = document.getElementById('articleBody');
        const isPreRendered = articleBody && articleBody.style.display === 'block';
        const preRenderedId = articleBody ? articleBody.getAttribute('data-id') : null;

        if (slug) {
            slug = slugify(decodeURIComponent(slug)).trim();
        }
        
        diag.log("Params extracted:", { id, slug, isPreRendered, preRenderedId });
        
        // If pre-rendered, we can immediately start loading related/trend
        if (isPreRendered) {
            const cat = document.getElementById('newsCategory').textContent;
            const currentId = id || preRenderedId;
            loadRelatedNews(cat, currentId);
            loadTrendNews(currentId);
            
            // Still handle view increment if we have an ID
            if (currentId && typeof db !== 'undefined') {
                try {
                    db.collection('news').doc(currentId).update({
                        views: firebase.firestore.FieldValue.increment(1)
                    });
                    diag.log("Views incremented (pre-rendered path)");
                } catch(e) { diag.log("View increment error", e.message); }
            }
            // We can stop here for the main article content
            if (!urlParams.has('force_reload')) return;
        }

        if (!id && !slug) {
            const parts = window.location.pathname.split('/').filter(p => !!p);
            diag.log("Path parts for slug extraction:", parts);
            
            // URL /bloq/slug formatÄ±nda olanda 'bloq' hissÉ™sini Ã§Ä±xÄ±rÄ±q
            if (parts.length >= 2 && parts[0] === 'bloq') {
                slug = parts[1].split('?')[0].split('#')[0];
                // .html uzantÄ±sÄ±nÄ± tÉ™mizlÉ™yÉ™k ki, Firestore 'slug' sahÉ™si ilÉ™ Ã¼st-Ã¼stÉ™ dÃ¼ÅŸsÃ¼n
                if (slug.endsWith('.html')) {
                    slug = slug.slice(0, -5);
                }
            } else if (parts.length === 1 && parts[0] !== 'bloq') {
                slug = parts[0].split('?')[0].split('#')[0];
                if (slug.endsWith('.html')) {
                    slug = slug.slice(0, -5);
                }
            }
            
            if (slug) {
                slug = slugify(decodeURIComponent(slug)).trim();
            }
            
            if (slug && (slug === 'view.html' || slug === 'index.html' || slug === 'bloq')) {
                slug = null;
            }
            
            if (slug) {
                diag.log("Extracted slug from path:", slug);
            }
        }
        
        // Ensure db is available
        if (typeof db === 'undefined') {
            diag.log("ERROR: Firestore 'db' is not defined!");
            document.getElementById('loading').innerHTML = '<p style="color:red; text-align:center; padding:20px;">Sistem xÉ™tasÄ±: VerilÉ™nlÉ™r bazasÄ± ilÉ™ É™laqÉ™ qurulmadÄ±.</p>';
            return;
        }
        
        if (slug && !id) {
            if (window.history && window.history.replaceState && window.location.protocol !== 'file:') {
                const cleanSlug = slug.split('?')[0];
                const newPath = '/bloq/' + cleanSlug;
                if (window.location.pathname !== newPath) {
                   window.history.replaceState({path: newPath}, '', newPath);
                   diag.log("Updated URL state to:", newPath);
                }
            }
        }

        // Try to find in cache first for instant load
        let localItem = null;
        try {
            if (id) {
                localItem = readLocalNews().find(n => n.id === id);
            }
            if (!localItem) {
                const sessionCache = sessionStorage.getItem('news_list_cache');
                if (sessionCache) {
                    const parsed = JSON.parse(sessionCache);
                    localItem = id ? parsed.data.find(n => n.id === id) : (slug ? parsed.data.find(n => n.slug === slug) : null);
                }
            }
        } catch (e) { diag.log("Cache read error", e.message); }

        if (localItem) {
            diag.log("Found in cache, rendering immediately");
            renderArticle(localItem);
            loadRelatedNews(localItem.category, localItem.id);
            loadTrendNews(localItem.id);
        } else {
            diag.log("Not found in cache, waiting for Firestore...");
            loadTrendNews();
        }

        // Global timeout for Firestore - reduced for better UX
        const loadingTimeout = setTimeout(() => {
            if (document.getElementById('loading').style.display !== 'none') {
                diag.log("TIMEOUT: Firestore taking too long.");
                document.getElementById('loading').innerHTML = `
                    <div style="text-align:center; padding: 40px;">
                        <i class="fas fa-wifi-slash" style="font-size: 48px; color: #ccc; margin-bottom: 20px;"></i>
                        <p style="color: #666; font-size: 18px;">BaÄŸlantÄ± zÉ™ifdir vÉ™ ya xÉ™bÉ™r tapÄ±lmadÄ±.</p>
                        <div style="display:flex; gap:10px; justify-content:center; margin-top:20px;">
                            <a href="javascript:location.reload()" style="padding:10px 20px; background:var(--primary-dark); color:white; border-radius:12px; text-decoration:none; font-weight:600;">YenidÉ™n yoxla</a>
                            <a href="/bloq" style="padding:10px 20px; background:#f3f4f6; color:var(--text-main); border-radius:12px; text-decoration:none; font-weight:600;">Bloqa qayÄ±t</a>
                        </div>
                    </div>
                `;
                // Fallback render
                try { renderTicker(getInitialData()); } catch(_) {}
            }
        }, 10000); // 10 seconds is more reasonable for mobile than 20s

        try {
            let articleData = null;
            
            // 1. Try Slug Query
            if (slug && !id) {
                try {
                    diag.log("Querying Firestore for slug:", slug);
                    const snap = await db.collection('news').where('slug','==',slug).limit(1).get();
                    if (!snap.empty) {
                        const d = snap.docs[0];
                        id = d.id;
                        articleData = { id: d.id, ...d.data() };
                        diag.log("Found by slug query", id);
                    } else {
                        diag.log("Slug query returned empty");
                    }
                } catch (e) {
                    diag.log("Slug query failed (missing index?)", e.message);
                }
            }
            
            // 2. Try Fallback Title Match (if slug query failed or no slug field)
            if (!articleData && slug && !id) {
                try {
                    diag.log("Trying fallback title-slug match (limit 200)...");
                    // Increased limit to 200 for better chance
                    const latestSnap = await db.collection('news').orderBy('date', 'desc').limit(200).get();
                    diag.log("Fallback search in docs count:", latestSnap.size);
                    const found = latestSnap.docs.find(d => {
                        const data = d.data();
                        return slugify(data.title) === slug || (data.slug === slug);
                    });
                    if (found) {
                        diag.log("Found article via fallback match!", found.id);
                        id = found.id;
                        articleData = { id: found.id, ...found.data() };
                    } else {
                        diag.log("Fallback match found nothing in latest 200");
                    }
                } catch (e) {
                    diag.log("Fallback match failed", e.message);
                    // If orderBy failed (index), try without it
                    try {
                        diag.log("Retrying fallback without orderBy...");
                        const snap2 = await db.collection('news').limit(200).get();
                        const found2 = snap2.docs.find(d => {
                            const data = d.data();
                            return slugify(data.title) === slug || (data.slug === slug);
                        });
                        if (found2) {
                            id = found2.id;
                            articleData = { id: found2.id, ...found2.data() };
                            diag.log("Found article via fallback (no orderBy)!", id);
                        }
                    } catch (e2) { diag.log("Fallback retry failed", e2.message); }
                }
            }
            
            // 3. Try Direct ID Query
            if (!articleData && id) {
                try {
                    diag.log("Querying Firestore for ID:", id);
                    const doc = await db.collection('news').doc(id).get();
                    if (doc.exists) {
                        articleData = { id: doc.id, ...doc.data() };
                        diag.log("Found by ID query");
                    } else {
                        diag.log("ID query returned non-existent doc");
                    }
                } catch (e) {
                    diag.log("ID query failed", e.message);
                }
            }

            // 4. Final Fallback to local data
            if (!articleData) {
                diag.log("Checking initial data fallback...");
                articleData = (typeof getInitialData === 'function' ? getInitialData().find(n => n.id === id || (slug && n.slug === slug)) : null);
            }

            if (!articleData) {
                diag.log("FINAL ERROR: Article not found anywhere.");
                clearTimeout(loadingTimeout);
                document.getElementById('loading').innerHTML = `
                    <div style="text-align:center; padding: 40px;">
                        <i class="fas fa-exclamation-circle" style="font-size: 48px; color: #ccc; margin-bottom: 20px;"></i>
                        <p style="color: #666; font-size: 18px;">MÉ™qalÉ™ tapÄ±lmadÄ± vÉ™ ya silinib.</p>
                        <a href="/bloq" style="display:inline-block; margin-top:20px; padding:10px 20px; background:var(--primary-dark); color:white; border-radius:12px; text-decoration:none; font-weight:600;">Bloqa qayÄ±t</a>
                    </div>
                `;
                return;
            }

            // Update views
            if (articleData && articleData.id) {
                 try {
                     db.collection('news').doc(articleData.id).update({
                        views: firebase.firestore.FieldValue.increment(1)
                    });
                    articleData.views = (articleData.views || 0) + 1;
                    diag.log("Views incremented");
                 } catch(e) { diag.log("View increment error", e.message); }
            }

            clearTimeout(loadingTimeout);
            diag.log("Success! Rendering article.");
            renderArticle(articleData);
            loadRelatedNews(articleData.category, articleData.id);
            loadTrendNews(articleData.id);

        } catch (error) {
            clearTimeout(loadingTimeout);
            diag.log("CRITICAL ERROR in loadArticle", error.message);
            document.getElementById('loading').innerHTML = `<p style="color: red; text-align:center; padding:20px;">XÉ™ta baÅŸ verdi: ${error.message}</p>`;
        }
    }

    function renderArticle(item) {
        if (!item) return;
        console.log("Rendering article:", item.id);
        
        try {
            document.title = `${item.title || 'MÉ™qalÉ™'} â€“ Ä°mtahan Bloq`;
            setSeoTags(item);
        } catch (e) {
            console.error("SEO/Title error:", e);
        }
        
        try {
            document.getElementById('newsCategory').textContent = item.category || 'Bloq';
            document.getElementById('newsTitle').textContent = item.title || '';
            
            const metaDiv = document.getElementById('newsMeta');
            if (metaDiv) {
                metaDiv.innerHTML = `
                    <span><i class="far fa-calendar"></i> ${formatDate(item.date)}</span>
                    <span><i class="far fa-clock"></i> ${item.readTime || 3} dÉ™q</span>
                    <span><i class="far fa-eye"></i> ${item.views || 0}</span>
                `;
            }

            if (item.imageUrl) {
                const img = document.getElementById('newsCover');
                if (img) {
                    img.src = item.imageUrl;
                    img.alt = item.title || 'MÉ™qalÉ™ ÅŸÉ™kli';
                    img.style.display = 'block';
                }
            }

            // Format content
            const content = item.content || item.excerpt || '';
            const contentDiv = document.getElementById('newsContent');
            if (contentDiv) {
                if (!content || content.trim() === '') {
                    contentDiv.innerHTML = '<p style="color:var(--text-muted); font-style:italic;">MÉ™zmun yoxdur.</p>';
                } else if (!content.trim().startsWith('<')) {
                    contentDiv.innerHTML = content.split('\n').map(p => `<p>${p}</p>`).join('');
                } else {
                    contentDiv.innerHTML = content;
                }
            }

            // Tags rendering
            const tagsContainer = document.getElementById('newsTags');
            if (tagsContainer) {
                if (item.tags && item.tags.length > 0) {
                    tagsContainer.innerHTML = item.tags.map(tag => `<span class="tag">#${tag}</span>`).join('');
                    tagsContainer.style.display = 'flex';
                } else {
                    tagsContainer.style.display = 'none';
                }
            }

            document.getElementById('loading').style.display = 'none';
            document.getElementById('articleBody').style.display = 'block';
            console.log("Article rendered successfully.");
            
        } catch (e) {
            console.error("Render inner error:", e);
            document.getElementById('loading').innerHTML = `<p style="color: red; text-align:center; padding:20px;">GÃ¶stÉ™rmÉ™ xÉ™tasÄ±: ${e.message}</p>`;
        }
    }

    async function loadRelatedNews(category, currentId) {
        try {
            // CACHE: OxÅŸar xÉ™bÉ™rlÉ™ri cache-dÉ™n oxuyaq
            const CACHE_KEY = `related_news_${category}`;
            const cached = sessionStorage.getItem(CACHE_KEY);
            let related = [];

            if (cached) {
                const parsed = JSON.parse(cached);
                // 30 dÉ™qiqÉ™lik cache
                if (Date.now() - parsed.timestamp < 30 * 60 * 1000) {
                    related = parsed.data;
                }
            }

            if (related.length === 0) {
                let query = db.collection('news')
                    .where('status', '==', 'published')
                    .where('category', '==', category);
                let snapshot;
                try {
                    snapshot = await query.orderBy('date', 'desc').limit(4).get();
                } catch (e) {
                    console.warn("Index missing for related query; falling back without orderBy:", e);
                    snapshot = await query.limit(4).get();
                }

                snapshot.forEach(doc => {
                    related.push({ id: doc.id, ...doc.data() });
                });

                // Save to cache
                if (related.length > 0) {
                    sessionStorage.setItem(CACHE_KEY, JSON.stringify({
                        timestamp: Date.now(),
                        data: related
                    }));
                }
            }

            // Filter out current article
            const filteredRelated = related.filter(item => item.id !== currentId).slice(0, 3);

            if (filteredRelated.length > 0) {
                const grid = document.getElementById('relatedGrid');
                grid.innerHTML = '';
                filteredRelated.forEach(item => {
                    grid.innerHTML += `
                        <a href="${getNewsLink(item)}" class="related-card" style="text-decoration: none;">
                            ${item.imageUrl ? `<img src="${item.imageUrl}" class="related-img" alt="${item.title}" onerror="this.insertAdjacentHTML('beforebegin','<div class=&quot;related-img&quot; style=&quot;background: var(--gradient-1)&quot;></div>'); this.remove();">` : `<div class="related-img" style="background: var(--gradient-1)"></div>`}
                            <div class="related-content">
                                <span class="related-cat">${item.category}</span>
                                <h4 class="related-head">${item.title}</h4>
                                <span class="related-date"><i class="far fa-calendar"></i> ${formatDate(item.date)}</span>
                            </div>
                        </a>
                    `;
                });
                document.getElementById('relatedSection').style.display = 'block';
            }
        } catch (e) {
            console.warn("Related news error:", e);
        }
    }

    async function loadTrendNews(currentId) {
        try {
            // CACHE: Trend xÉ™bÉ™rlÉ™ri sessiya yaddaÅŸÄ±ndan oxuyaq ki, hÉ™r sÉ™hifÉ™dÉ™ sorÄŸu getmÉ™sin
            const CACHE_KEY = 'trend_news_cache';
            const cached = sessionStorage.getItem(CACHE_KEY);
            let all = [];

            if (cached) {
                const parsed = JSON.parse(cached);
                // 15 dÉ™qiqÉ™lik cache
                if (Date.now() - parsed.timestamp < 15 * 60 * 1000) {
                    all = parsed.data;
                }
            }

            if (all.length === 0) {
                let query = db.collection('news').where('status', '==', 'published');
                let snapshot;
                try {
                    // Limit 10 to reduce reads
                    snapshot = await query.orderBy('date', 'desc').limit(10).get();
                } catch (e) {
                    console.warn("Index missing for trend query; falling back without orderBy:", e);
                    snapshot = await query.limit(10).get();
                }

                snapshot.forEach(doc => {
                    all.push({ id: doc.id, ...doc.data() });
                });

                // Save to cache
                if (all.length > 0) {
                    sessionStorage.setItem(CACHE_KEY, JSON.stringify({
                        timestamp: Date.now(),
                        data: all
                    }));
                }
            }

            const local = readLocalNews();
            const existing = new Set(all.map(n => n.id));
            const merged = [...local.filter(n => !existing.has(n.id)), ...all];

            // Render Ticker with all latest news
            renderTicker(merged);

            // Filter for trends (exclude current)
            const trendItems = merged.filter(item => item.id !== currentId);

            // Shuffle and pick 3
            trendItems.sort(() => 0.5 - Math.random());
            const trends = trendItems.slice(0, 3);

            if (trends.length > 0) {
                const grid = document.getElementById('trendGrid');
                if (grid) {
                    grid.innerHTML = '';
                    trends.forEach(item => {
                        grid.innerHTML += `
                            <a href="${getNewsLink(item)}" class="mini-card">
                                ${item.imageUrl ? `<img src="${item.imageUrl}" class="mini-img" alt="${item.title}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxIiBoZWlnaHQ9IjEiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IiM2MzY2ZjEiLz48L3N2Zz4='">` : `<div class="mini-img" style="background: var(--gradient-2)"></div>`}
                                <div class="mini-content">
                                    <span class="mini-cat">${item.category}</span>
                                    <h4 class="mini-head">${item.title}</h4>
                                    <span class="mini-date"><i class="far fa-eye"></i> Ã‡ox oxunan</span>
                                </div>
                            </a>
                        `;
                    });
                    document.getElementById('trendSection').style.display = 'block';
                }
            }
        } catch (e) {
            console.warn("Trend news error:", e);
            // Fallback for trends
            const allInitial = getInitialData();
            renderTicker(allInitial); // Fallback ticker
            
            const trends = allInitial.slice(0, 3);
            const grid = document.getElementById('trendGrid');
            if (grid) {
                grid.innerHTML = '';
                trends.forEach(item => {
                    grid.innerHTML += `
                            <a href="${getNewsLink(item)}" class="mini-card">
                                ${item.imageUrl ? `<img src="${item.imageUrl}" class="mini-img" alt="${item.title}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxIiBoZWlnaHQ9IjEiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IiM2MzY2ZjEiLz48L3N2Zz4='">` : `<div class="mini-img" style="background: var(--gradient-2)"></div>`}
                                <div class="mini-content">
                                    <span class="mini-cat">${item.category}</span>
                                    <h4 class="mini-head">${item.title}</h4>
                                    <span class="mini-date"><i class="far fa-eye"></i> Ã‡ox oxunan</span>
                                </div>
                            </a>
                    `;
                });
                document.getElementById('trendSection').style.display = 'block';
            }
        }
    }

    function renderTicker(news) {
        const tickerContent = document.getElementById('newsTickerContent');
        if (!tickerContent) return;

        if (!news || news.length === 0) {
            tickerContent.innerHTML = '';
            return;
        }

        let itemsToRender = news.slice(0, 10);
        if (itemsToRender.length < 5) {
            itemsToRender = [...itemsToRender, ...itemsToRender, ...itemsToRender];
        }

        const itemsHtml = itemsToRender.map(item => `
            <a href="${getNewsLink(item)}" class="ticker-item">
                ${item.category ? `<span style="color:var(--secondary); font-weight:bold; margin-right:5px;">[${item.category.toUpperCase()}]</span>` : ''}
                ${escapeHtml(item.title)}
            </a>
        `).join('');

        // Double content for seamless loop
        tickerContent.innerHTML = itemsHtml + itemsHtml;

        // Apply CSS Animation without forced reflow
        tickerContent.style.display = 'flex';
        tickerContent.style.width = 'max-content';
        tickerContent.style.animation = 'none'; 
        requestAnimationFrame(() => {
            requestAnimationFrame(() => {
                tickerContent.style.animation = 'ticker-scroll 40s linear infinite';
            });
        });
    }

    function escapeHtml(text) {
        if (!text) return '';
        return text
            .replace(/&/g, "&amp;")
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&#039;");
    }

    function shareArticle(platform) {
        const url = encodeURIComponent(window.location.href);
        const title = encodeURIComponent(document.title);
        
        let shareUrl = '';
        if (platform === 'facebook') shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
        if (platform === 'twitter') shareUrl = `https://twitter.com/intent/tweet?url=${url}&text=${title}`;
        if (platform === 'linkedin') shareUrl = `https://www.linkedin.com/shareArticle?mini=true&url=${url}&title=${title}`;
        
        if (platform === 'copy') {
            navigator.clipboard.writeText(window.location.href);
            alert('Link kopyalandÄ±!');
            return;
        }
        
        window.open(shareUrl, '_blank', 'width=600,height=400');
    }

    function getInitialData() {
        return [
            {
                id: '1',
                title: 'Yeni TÉ™dris ProqramÄ± TÉ™sdiqlÉ™ndi',
                excerpt: 'TÉ™hsil Nazirliyi tÉ™rÉ™findÉ™n tÉ™sdiqlÉ™nmiÅŸ yeni kurikulum standartlarÄ±...',
                content: 'Tam mÉ™tn buradadÄ±r...',
                category: 'rÉ™smi',
                date: '2026-01-05',
                readTime: 3,
                imageUrl: ''
            }
            // ... truncated for brevity
        ];
    }

    document.addEventListener('DOMContentLoaded', () => {
        initFirebase();
        loadArticle();
    });
  </script>
</body>
</html>
